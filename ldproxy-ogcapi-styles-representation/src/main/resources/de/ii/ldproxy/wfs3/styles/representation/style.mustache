<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Style {{styleId}}</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v5.3.0/css/ol.css" type="text/css"/>

    <style>
        #map {
            position: relative;
        }

        #info {
            z-index: 1;
            opacity: 0;
            position: absolute;
            bottom: 0;
            left: 0;
            margin: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            border: 0;
            transition: opacity 100ms ease-in;
        }
    </style>
</head>
<body>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/openlayers.github.io@master/en/v5.3.0/build/ol.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/openlayers/ol-mapbox-style@v4.3.1/dist/olms.js"></script>

    <div id="map-container">
        <pre id="info" />
    </div>
    <button id="roundButton" onmousedown=showLayerSelector()></button>

    <div id="layerSelector">

    </div>
</body>

<script>
    {{#bbox}}
    const extent = ol.proj.transformExtent([{{minLat}},{{minLng}},{{maxLat}},{{maxLng}}], 'EPSG:4326', 'EPSG:3857');
    {{/bbox}}
    {{^bbox}}
    const extent = ol.proj.transformExtent([-180,-90,180,90], 'EPSG:4326', 'EPSG:3857');
    {{/bbox}}
    var map = olms.apply('map-container', '{{{styleUrl}}}');
    map.getView().fit(extent, map.getSize());

    map.on('pointermove', showInfo);

    var info = document.getElementById('info');
    function showInfo(event) {
        var features = map.getFeaturesAtPixel(event.pixel);
        if (!features) {
            info.innerText = '';
            info.style.opacity = 0;
            return;
        }
        var properties = features[0].getProperties();
        info.innerText = JSON.stringify(properties, null, 2);
        info.style.opacity = 1;
    }
</script>
</html>
