(function(R,me){typeof exports=="object"&&typeof module!="undefined"?module.exports=me(require("ol/interaction/Draw"),require("ol/interaction/Modify"),require("ol/interaction/Snap"),require("ol/interaction/Interaction"),require("ol/format/GeoJSON"),require("ol/source/Vector"),require("ol/layer/Vector"),require("ol/proj/Projection"),require("ol/loadingstrategy"),require("ol/tilegrid"),require("ol/style"),require("ol/geom"),require("ol/control/Control")):typeof define=="function"&&define.amd?define(["ol/interaction/Draw","ol/interaction/Modify","ol/interaction/Snap","ol/interaction/Interaction","ol/format/GeoJSON","ol/source/Vector","ol/layer/Vector","ol/proj/Projection","ol/loadingstrategy","ol/tilegrid","ol/style","ol/geom","ol/control/Control"],me):(R=typeof globalThis!="undefined"?globalThis:R||self,R.OgcApiEditor=me(R.ol.interaction.Draw,R.ol.interaction.Modify,R.ol.interaction.Snap,R.ol.interaction.Interaction,R.ol.format.GeoJSON,R.ol.source.Vector,R.ol.layer.Vector,R.ol.proj.Projection,R.ol.loadingstrategy,R.ol.tilegrid,R.ol.style,R.ol.geom,R.ol.control.Control))})(this,function(R,me,jt,Rt,Ft,Mt,Gt,Dt,Yt,zt,v,we,Vt){"use strict";function Q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var qt=Q(R),Ut=Q(me),Ht=Q(jt),Jt=Q(Rt),ye=Q(Ft),Be=Q(Mt),Xe=Q(Gt),Ze=Q(Dt),Ke=Q(Vt);const Qe=(t,e,n,l,o,i)=>fetch(`${t}/collections/${e}/items/${n}?${o}${l?"&crs="+l:""}`,{headers:{Accept:"application/geo+json",...te(i)}}).then(We(!0)),Bt=(t,e,n,l,o)=>fetch(`${t}/collections/${e}/items`,{headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`,...te(o)},method:"POST",body:JSON.stringify(n)}).then(Ee).then(Wt),Xt=(t,e,n,l,o,i)=>{const r={"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`,Accept:"application/json",...te(i)};return o&&(r["If-Match"]=o),fetch(`${t}/collections/${e}/items/${n.id}`,{headers:r,method:"PUT",body:JSON.stringify(n)}).then(Ee)},Zt=(t,e,n,l,o,i)=>{const r={"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`,Accept:"application/json",...te(i)};return o&&(r["If-Match"]=o),fetch(`${t}/collections/${e}/items/${n.id}`,{headers:r,method:"PATCH",body:JSON.stringify(n)}).then(Ee)},Kt=(t,e,n,l)=>fetch(`${t}/collections/${e}/items/${n}`,{headers:te(l),method:"DELETE"}).then(Ee),Qt=(t,e,n,l)=>{const o=n&&n.custom||n.replace;return fetch(`${t}/collections/${e}/${o}`,{headers:{Accept:"application/schema+json",...te(l)}}).then(We(!1))},We=t=>e=>(console.log("ETag",e.headers.get("etag")),e&&e.ok?e.json().then(n=>t?{feature:n,etag:e.headers.get("etag")}:n):t?{feature:{},etag:e.headers.get("etag")}:{}),Wt=t=>t&&t.ok?t.headers.get("location").substr(t.headers.get("location").lastIndexOf("/")+1):void 0,Ee=t=>{if(t.ok)return t;if(t.bodyUsed)return t.json().then(e=>{Re(t,e.detail)}).catch(()=>{Re(t)});Re(t)},Re=(t,e)=>{t.status;let n=t.status+" "+t.statusText;throw e&&(n+="<br/>"+e),new Error(n)},te=t=>t?{Authorization:"Bearer "+t}:{},j={NONE:"NONE",CREATE:"CREATE",EDIT:"EDIT"},D={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Y={IDLE:"IDLE",SYNC:"SYNC",SUCCESS:"SUCCESS",ERROR:"ERROR",CONFLICT:"CONFLICT"};class $t extends Jt.default{constructor(e){super();const n=e||{};this._onSelect=n.onSelect||null,this._collections=n._collections||[]}handleEvent(e){let n=!1;if(e.type==="click"){const l=e.map,o=[];l.forEachFeatureAtPixel(e.pixel,(i,r)=>{o.push({feature:i,layer:r.get("collection")})},{layerFilter:i=>this._collections.length===0||this._collections.includes(i.get("collection"))}),o.length>0&&(this.setActive(!1),this._onSelect(o)),n=!0}return!n}}function U(){}function xt(t,e){for(const n in e)t[n]=e[n];return t}function $e(t){return t()}function xe(){return Object.create(null)}function ne(t){t.forEach($e)}function ve(t){return typeof t=="function"}function le(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function en(t){return Object.keys(t).length===0}function Fe(t,...e){if(t==null)return U;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function k(t){let e;return Fe(t,n=>e=n)(),e}function J(t,e,n){t.$$.on_destroy.push(Fe(e,n))}function et(t,e,n,l){if(t){const o=tt(t,e,n,l);return t[0](o)}}function tt(t,e,n,l){return t[1]&&l?xt(n.ctx.slice(),t[1](l(e))):n.ctx}function nt(t,e,n,l){if(t[2]&&l){const o=t[2](l(n));if(e.dirty===void 0)return o;if(typeof o=="object"){const i=[],r=Math.max(e.dirty.length,o.length);for(let s=0;s<r;s+=1)i[s]=e.dirty[s]|o[s];return i}return e.dirty|o}return e.dirty}function lt(t,e,n,l,o,i){if(o){const r=tt(e,n,l,i);t.p(r,o)}}function ot(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function E(t,e){t.appendChild(e)}function T(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode.removeChild(t)}function it(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function N(t){return document.createElement(t)}function se(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function B(t){return document.createTextNode(t)}function F(){return B(" ")}function rt(){return B("")}function ae(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function tn(t){return Array.from(t.childNodes)}function Oe(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function X(t,e,n){t.classList[n?"add":"remove"](e)}let Me;function _e(t){Me=t}function st(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(l=>l.call(this,e))}const pe=[],at=[],Se=[],ct=[],nn=Promise.resolve();let Ge=!1;function ln(){Ge||(Ge=!0,nn.then(ft))}function De(t){Se.push(t)}const Ye=new Set;let Te=0;function ft(){const t=Me;do{for(;Te<pe.length;){const e=pe[Te];Te++,_e(e),on(e.$$)}for(_e(null),pe.length=0,Te=0;at.length;)at.pop()();for(let e=0;e<Se.length;e+=1){const n=Se[e];Ye.has(n)||(Ye.add(n),n())}Se.length=0}while(pe.length);for(;ct.length;)ct.pop()();Ge=!1,Ye.clear(),_e(t)}function on(t){if(t.fragment!==null){t.update(),ne(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(De)}}const Le=new Set;let oe;function ce(){oe={r:0,c:[],p:oe}}function fe(){oe.r||ne(oe.c),oe=oe.p}function C(t,e){t&&t.i&&(Le.delete(t),t.i(e))}function O(t,e,n,l){if(t&&t.o){if(Le.has(t))return;Le.add(t),oe.c.push(()=>{Le.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function H(t){t&&t.c()}function V(t,e,n,l){const{fragment:o,on_mount:i,on_destroy:r,after_update:s}=t.$$;o&&o.m(e,n),l||De(()=>{const c=i.map($e).filter(ve);r?r.push(...c):ne(c),t.$$.on_mount=[]}),s.forEach(De)}function q(t,e){const n=t.$$;n.fragment!==null&&(ne(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function rn(t,e){t.$$.dirty[0]===-1&&(pe.push(t),ln(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ue(t,e,n,l,o,i,r,s=[-1]){const c=Me;_e(t);const a=t.$$={fragment:null,ctx:null,props:i,update:U,not_equal:o,bound:xe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:xe(),dirty:s,skip_bound:!1,root:e.target||c.$$.root};r&&r(a.root);let u=!1;if(a.ctx=n?n(t,e.props||{},(d,f,...h)=>{const b=h.length?h[0]:f;return a.ctx&&o(a.ctx[d],a.ctx[d]=b)&&(!a.skip_bound&&a.bound[d]&&a.bound[d](b),u&&rn(t,d)),f}):[],a.update(),u=!0,ne(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){const d=tn(e.target);a.fragment&&a.fragment.l(d),d.forEach(S)}else a.fragment&&a.fragment.c();e.intro&&C(t.$$.fragment),V(t,e.target,e.anchor,e.customElement),ft()}_e(c)}class de{$destroy(){q(this,1),this.$destroy=U}$on(e,n){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!en(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ge=[];function sn(t,e){return{subscribe:z(t,e).subscribe}}function z(t,e=U){let n;const l=new Set;function o(s){if(le(t,s)&&(t=s,n)){const c=!ge.length;for(const a of l)a[1](),ge.push(a,t);if(c){for(let a=0;a<ge.length;a+=2)ge[a][0](ge[a+1]);ge.length=0}}}function i(s){o(s(t))}function r(s,c=U){const a=[s,c];return l.add(a),l.size===1&&(n=e(o)||U),s(t),()=>{l.delete(a),l.size===0&&(n(),n=null)}}return{set:o,update:i,subscribe:r}}function be(t,e,n){const l=!Array.isArray(t),o=l?[t]:t,i=e.length<2;return sn(n,r=>{let s=!1;const c=[];let a=0,u=U;const d=()=>{if(a)return;u();const h=e(l?c[0]:c,r);i?r(h):u=ve(h)?h:U},f=o.map((h,b)=>Fe(h,_=>{c[b]=_,a&=~(1<<b),s&&d()},()=>{a|=1<<b}));return s=!0,d(),function(){ne(f),u()}})}const an=(t,e,n,l,o,i)=>{const r=new Be.default({format:new ye.default({dataProjection:Ie(l)}),loader:function(c,a,u,d,f){const h=`${t}/collections/${e}/items?f=json&limit=${n}&bbox=`+c[0]+","+c[1]+","+c[2]+","+c[3]+"&bbox-crs="+encodeURIComponent(fn(u))+"&crs="+encodeURIComponent(l);fetch(h,{headers:te(i)}).then(b=>b.ok?b.json().then(_=>{var L=r.getFormat().readFeatures(_,{featureProjection:u});r.addFeatures(L),d(L)}):b.text().then(_=>f(`${b.status} ${b.statusText} - ${_}`)))},strategy:Yt.tile(zt.createXYZ({tileSize:512}))});return new Xe.default({source:r,properties:{collection:e},style:o})},cn=(t,e,n)=>{const l=new ye.default({dataProjection:Ie(t)}),o=new Be.default({});return Z.subscribe(i=>{if(i){const r=l.readFeature(i,{featureProjection:n});o.addFeature(r)}else o.clear()}),W.subscribe(i=>{i&&o.clear()}),new Xe.default({source:o,style:e})},fn=t=>t.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),Ie=t=>t==="http://www.opengis.net/def/crs/OGC/1.3/CRS84"?new Ze.default({code:"EPSG:4326",axisOrientation:"neu"}):new Ze.default({code:t.replace("http://www.opengis.net/def/crs/EPSG/0/","EPSG:")}),ut=(t,e,n={},l=1,o="")=>Object.keys(t).flatMap(i=>t[i].type==="object"?[{name:o+i,label:t[i].title||i,isValue:!1,depth:l}].concat(ut(t[i].properties,e[i]||{},n,l+1,o+i+".")):{name:o+i,label:t[i].title||i,value:n[o+i]||e[i]||"",isDirty:n[o+i]&&n[o+i]!==e[i],isValue:!0,depth:l}),ze=(t,e)=>{const n={...t};if(n.properties){const l=n.properties;Object.keys(l).forEach(o=>{l[o].$ref&&l[o].$ref.includes("$defs")&&(l[o]=e[l[o].$ref.substr(8)]),l[o].type==="object"&&(l[o]=ze(l[o],e)),l[o].type==="array"&&delete l[o]})}return n},dt=(t,e)=>{const n=ze(t,e),l=[];return n.properties&&n.properties.type&&n.properties.type.enum&&l.push(...n.properties.type.enum),n.oneOf&&n.oneOf.forEach(o=>{o.type==="object"&&l.push(...dt(o,e))}),l},un=(t,e)=>new ye.default({featureProjection:t,dataProjection:Ie(e)}),dn=(t,e,n)=>{const l=k(ee)===j.CREATE?{type:"Feature",properties:{}}:n?{id:k(Z).id,properties:{}}:k(Z);if(k(ie)){const o=new ye.default({featureProjection:t,dataProjection:Ie(e)});l.geometry=o.writeGeometryObject(k(ie),{rightHanded:!0,decimals:10})}if(k(re)){const o=k(re),i={...l.properties};Object.keys(o).forEach(r=>{const s=r.split(".");let c=i;for(let a=0;a<s.length-1;a++)c[s[a]]||(c[s[a]]={}),c=c[s[a]];c[s[s.length-1]]=o[r]}),l.properties=i}return l},ee=z(j.NONE),K=z(Y.IDLE),ke=z(),W=z(!0),gt=z(),ht=be([ee,K,ke,W],([t,e,n,l])=>({tool:t,sync:e,geo:n,panelOff:l})),Ce=z(),Ne=z(),Z=z(),Pe=z(),Ae=z(),$=z(""),mt=z(""),ie=z(),re=z(),_t=be([Ae,$],([t,e])=>t&&t[e]?t[e].geoTypes:[]),gn=be([ke,_t],([t,e])=>t&&e.includes(t)?t:e.length>0?e[0]:!1),pt=be([ee,Z,ie,re],([t,e,n,l])=>{const o=t===j.CREATE||e&&n;if(!o&&e&&l){const i=e.properties,r=l;return Object.keys(r).some(s=>r[s]!==i[s])}return o}),hn=be([Ae,$,Z,re,ee,W],([t,e,n,l,o,i])=>!i&&t&&t[e]&&(n||o===j.CREATE)?ut(t[e].properties,n&&n.properties||{},l):[]),bt=()=>{k(Ne)&&k(Ce)&&k(Ce)(k(Ne)),Pe.set(void 0),Ne.set(void 0),Z.set(void 0),Ce.set(void 0),ie.set(void 0),re.set(void 0),K.set(Y.IDLE),W.set(!0)},mn=t=>{const e=new Ut.default({source:t});return e.on("modifyend",n=>{n.features&&n.features.getLength()>0&&(console.log("mod",n.features.item(0).getGeometry().getRevision()),ie.set(n.features.item(0).getGeometry()))}),W.subscribe(n=>{console.log("MODIFY",!n),e.setActive(!n)}),e},_n=t=>new Ht.default({source:t}),pn=(t,e,n,l,o)=>{const i=new $t({collections:Object.keys(e),onSelect:r=>{const s=r[0],c=e[s.layer],a=s.feature.getId();Ne.set(s.feature),Ce.set(u=>n.addFeature(u)),n.removeFeature(s.feature),Qe(t,c.id,a,c.crs,l,o).then(u=>{$.set(c.id),mt.set(u.feature.id),Z.set(u.feature),Pe.set(u.etag),W.set(!1)})}});return i.setActive(!1),ht.subscribe(r=>{i.setActive(r.panelOff&&r.tool===j.EDIT)}),i},bn=(t,e)=>{const n={};return[D.POINT,D.LINE_STRING,D.POLYGON].forEach(l=>{const o=new qt.default({source:t,type:l});o.setActive(!1),o.on("drawend",i=>{console.log(i.feature.getGeometry().getRevision()),$.set(e.id),W.set(!1),ie.set(i.feature.getGeometry())}),n[l]=o}),ht.subscribe(l=>{Object.keys(n).forEach(o=>{n[o].setActive(l.geo===o&&l.tool===j.CREATE&&l.panelOff)})}),Object.values(n)},Cn=({color:t,strokeWidth:e,circleRadius:n,fillOpacity:l})=>{const o={Point:new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})})}),LineString:[new v.Style({stroke:new v.Stroke({color:t,width:e})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(i){const r=i.getGeometry().getCoordinates();return new we.MultiPoint(r)}})],MultiLineString:new v.Style({stroke:new v.Stroke({color:t,width:e})}),MultiPoint:[new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(i){const r=i.getGeometry().getCoordinates().reduce((s,c)=>s.concat(c),[]);return new we.MultiPoint(r)}})],MultiPolygon:[new v.Style({stroke:new v.Stroke({color:t,width:e}),fill:new v.Fill({color:"rgba(255, 0, 0, 0.5)"})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(i){const r=i.getGeometry().getCoordinates().reduce((s,c)=>s.concat(c[0]),[]);return new we.MultiPoint(r)}})],Polygon:[new v.Style({stroke:new v.Stroke({color:t,width:e}),fill:new v.Fill({color:"rgba(255, 0, 0, 0.5)"})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(i){const r=i.getGeometry().getCoordinates().reduce((s,c)=>s.concat(c),[]);return new we.MultiPoint(r)}})]};return i=>o[i.getGeometry().getType()]},je=parseFloat;function Ve(t,e=";"){let n;if(Array.isArray(t))n=t.filter(l=>l);else{n=[];for(const l in t)t[l]&&n.push(`${l}:${t[l]}`)}return n.join(e)}function wn(t,e,n,l){let o,i;const r="1em";let s,c,a,u="-.125em";const d="visible";return l&&(a="center",i="1.25em"),n&&(o=n),e&&(e=="lg"?(c="1.33333em",s=".75em",u="-.225em"):e=="xs"?c=".75em":e=="sm"?c=".875em":c=e.replace("x","em")),Ve([Ve({float:o,width:i,height:r,"line-height":s,"font-size":c,"text-align":a,"vertical-align":u,"transform-origin":"center",overflow:d}),t])}function yn(t,e,n,l,o,i=1,r="",s=""){let c=1,a=1;return o&&(o=="horizontal"?c=-1:o=="vertical"?a=-1:c=a=-1),Ve([`translate(${je(e)*i}${r},${je(n)*i}${r})`,`scale(${c*je(t)},${a*je(t)})`,l&&`rotate(${l}${s})`]," ")}var ll="";function Ct(t){let e,n,l,o,i,r,s,c;function a(f,h){return typeof f[10][4]=="string"?vn:En}let u=a(t),d=u(t);return{c(){e=se("svg"),n=se("g"),l=se("g"),d.c(),g(l,"transform",t[12]),g(n,"transform",o="translate("+t[10][0]/2+" "+t[10][1]/2+")"),g(n,"transform-origin",i=t[10][0]/4+" 0"),g(e,"id",r=t[1]||void 0),g(e,"class",s="svelte-fa "+t[0]+" svelte-1w3t65e"),g(e,"style",t[11]),g(e,"viewBox",c="0 0 "+t[10][0]+" "+t[10][1]),g(e,"aria-hidden","true"),g(e,"role","img"),g(e,"xmlns","http://www.w3.org/2000/svg"),X(e,"pulse",t[4]),X(e,"spin",t[3])},m(f,h){T(f,e,h),E(e,n),E(n,l),d.m(l,null)},p(f,h){u===(u=a(f))&&d?d.p(f,h):(d.d(1),d=u(f),d&&(d.c(),d.m(l,null))),h&4096&&g(l,"transform",f[12]),h&1024&&o!==(o="translate("+f[10][0]/2+" "+f[10][1]/2+")")&&g(n,"transform",o),h&1024&&i!==(i=f[10][0]/4+" 0")&&g(n,"transform-origin",i),h&2&&r!==(r=f[1]||void 0)&&g(e,"id",r),h&1&&s!==(s="svelte-fa "+f[0]+" svelte-1w3t65e")&&g(e,"class",s),h&2048&&g(e,"style",f[11]),h&1024&&c!==(c="0 0 "+f[10][0]+" "+f[10][1])&&g(e,"viewBox",c),h&17&&X(e,"pulse",f[4]),h&9&&X(e,"spin",f[3])},d(f){f&&S(e),d.d()}}}function En(t){let e,n,l,o,i,r,s,c,a,u;return{c(){e=se("path"),r=se("path"),g(e,"d",n=t[10][4][0]),g(e,"fill",l=t[6]||t[2]||"currentColor"),g(e,"fill-opacity",o=t[9]!=!1?t[7]:t[8]),g(e,"transform",i="translate("+t[10][0]/-2+" "+t[10][1]/-2+")"),g(r,"d",s=t[10][4][1]),g(r,"fill",c=t[5]||t[2]||"currentColor"),g(r,"fill-opacity",a=t[9]!=!1?t[8]:t[7]),g(r,"transform",u="translate("+t[10][0]/-2+" "+t[10][1]/-2+")")},m(d,f){T(d,e,f),T(d,r,f)},p(d,f){f&1024&&n!==(n=d[10][4][0])&&g(e,"d",n),f&68&&l!==(l=d[6]||d[2]||"currentColor")&&g(e,"fill",l),f&896&&o!==(o=d[9]!=!1?d[7]:d[8])&&g(e,"fill-opacity",o),f&1024&&i!==(i="translate("+d[10][0]/-2+" "+d[10][1]/-2+")")&&g(e,"transform",i),f&1024&&s!==(s=d[10][4][1])&&g(r,"d",s),f&36&&c!==(c=d[5]||d[2]||"currentColor")&&g(r,"fill",c),f&896&&a!==(a=d[9]!=!1?d[8]:d[7])&&g(r,"fill-opacity",a),f&1024&&u!==(u="translate("+d[10][0]/-2+" "+d[10][1]/-2+")")&&g(r,"transform",u)},d(d){d&&S(e),d&&S(r)}}}function vn(t){let e,n,l,o;return{c(){e=se("path"),g(e,"d",n=t[10][4]),g(e,"fill",l=t[2]||t[5]||"currentColor"),g(e,"transform",o="translate("+t[10][0]/-2+" "+t[10][1]/-2+")")},m(i,r){T(i,e,r)},p(i,r){r&1024&&n!==(n=i[10][4])&&g(e,"d",n),r&36&&l!==(l=i[2]||i[5]||"currentColor")&&g(e,"fill",l),r&1024&&o!==(o="translate("+i[10][0]/-2+" "+i[10][1]/-2+")")&&g(e,"transform",o)},d(i){i&&S(e)}}}function On(t){let e,n=t[10][4]&&Ct(t);return{c(){n&&n.c(),e=rt()},m(l,o){n&&n.m(l,o),T(l,e,o)},p(l,[o]){l[10][4]?n?n.p(l,o):(n=Ct(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:U,o:U,d(l){n&&n.d(l),l&&S(e)}}}function Sn(t,e,n){let{class:l=""}=e,{id:o=""}=e,{style:i=""}=e,{icon:r}=e,{size:s=""}=e,{color:c=""}=e,{fw:a=!1}=e,{pull:u=""}=e,{scale:d=1}=e,{translateX:f=0}=e,{translateY:h=0}=e,{rotate:b=""}=e,{flip:_=!1}=e,{spin:L=!1}=e,{pulse:x=!1}=e,{primaryColor:y=""}=e,{secondaryColor:M=""}=e,{primaryOpacity:G=1}=e,{secondaryOpacity:p=.4}=e,{swapOpacity:I=!1}=e,P,A,w;return t.$$set=m=>{"class"in m&&n(0,l=m.class),"id"in m&&n(1,o=m.id),"style"in m&&n(13,i=m.style),"icon"in m&&n(14,r=m.icon),"size"in m&&n(15,s=m.size),"color"in m&&n(2,c=m.color),"fw"in m&&n(16,a=m.fw),"pull"in m&&n(17,u=m.pull),"scale"in m&&n(18,d=m.scale),"translateX"in m&&n(19,f=m.translateX),"translateY"in m&&n(20,h=m.translateY),"rotate"in m&&n(21,b=m.rotate),"flip"in m&&n(22,_=m.flip),"spin"in m&&n(3,L=m.spin),"pulse"in m&&n(4,x=m.pulse),"primaryColor"in m&&n(5,y=m.primaryColor),"secondaryColor"in m&&n(6,M=m.secondaryColor),"primaryOpacity"in m&&n(7,G=m.primaryOpacity),"secondaryOpacity"in m&&n(8,p=m.secondaryOpacity),"swapOpacity"in m&&n(9,I=m.swapOpacity)},t.$$.update=()=>{t.$$.dirty&16384&&n(10,P=r&&r.icon||[0,0,"",[],""]),t.$$.dirty&237568&&n(11,A=wn(i,s,u,a)),t.$$.dirty&8126464&&n(12,w=yn(d,f,h,b,_,512))},[l,o,c,L,x,y,M,G,p,I,P,A,w,i,r,s,a,u,d,f,h,b,_]}class Tn extends de{constructor(e){super(),ue(this,e,Sn,On,le,{class:0,id:1,style:13,icon:14,size:15,color:2,fw:16,pull:17,scale:18,translateX:19,translateY:20,rotate:21,flip:22,spin:3,pulse:4,primaryColor:5,secondaryColor:6,primaryOpacity:7,secondaryOpacity:8,swapOpacity:9})}}var qe=Tn;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var Ln={prefix:"fas",iconName:"draw-polygon",icon:[448,512,[],"f5ee","M384.3 352C419.5 352.2 448 380.7 448 416C448 451.3 419.3 480 384 480C360.3 480 339.6 467.1 328.6 448H119.4C108.4 467.1 87.69 480 64 480C28.65 480 0 451.3 0 416C0 392.3 12.87 371.6 32 360.6V151.4C12.87 140.4 0 119.7 0 96C0 60.65 28.65 32 64 32C87.69 32 108.4 44.87 119.4 64H328.6C339.6 44.87 360.3 32 384 32C419.3 32 448 60.65 448 96C448 131.3 419.5 159.8 384.3 159.1L345.5 227.9C349.7 236.4 352 245.9 352 256C352 266.1 349.7 275.6 345.5 284.1L384.3 352zM96 360.6C105.7 366.2 113.8 374.3 119.4 384H328.6C328.6 383.9 328.7 383.8 328.7 383.7L292.2 319.9C290.8 319.1 289.4 320 288 320C252.7 320 224 291.3 224 256C224 220.7 252.7 192 288 192C289.4 192 290.8 192 292.2 192.1L328.7 128.3L328.6 128H119.4C113.8 137.7 105.7 145.8 96 151.4L96 360.6z"]},In={prefix:"fas",iconName:"location-pin",icon:[384,512,["map-marker"],"f041","M384 192C384 279.4 267 435 215.7 499.2C203.4 514.5 180.6 514.5 168.3 499.2C116.1 435 0 279.4 0 192C0 85.96 85.96 0 192 0C298 0 384 85.96 384 192H384z"]},kn=In,Nn={prefix:"fas",iconName:"pencil",icon:[512,512,[61504,9999,"pencil-alt"],"f303","M421.7 220.3L188.5 453.4L154.6 419.5L158.1 416H112C103.2 416 96 408.8 96 400V353.9L92.51 357.4C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6L137.6 429.6C143.1 427.7 149.8 424.2 154.6 419.5L188.5 453.4C178.1 463.8 165.2 471.5 151.1 475.6L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1C.8198 498.8-1.502 489.7 .976 481.2L36.37 360.9C40.53 346.8 48.16 333.9 58.57 323.5L291.7 90.34L421.7 220.3zM492.7 58.75C517.7 83.74 517.7 124.3 492.7 149.3L444.3 197.7L314.3 67.72L362.7 19.32C387.7-5.678 428.3-5.678 453.3 19.32L492.7 58.75z"]},Pn={prefix:"fas",iconName:"slash",icon:[640,512,[],"f715","M5.112 9.196C13.29-1.236 28.37-3.065 38.81 5.112L630.8 469.1C641.2 477.3 643.1 492.4 634.9 502.8C626.7 513.2 611.6 515.1 601.2 506.9L9.196 42.89C-1.236 34.71-3.065 19.63 5.112 9.196V9.196z"]};function An(t){let e,n,l,o,i;const r=t[5].default,s=et(r,t,t[4],null);return{c(){e=N("button"),s&&s.c(),e.disabled=n=!t[0],g(e,"title",t[2]),g(e,"class","disabled:opacity-70 hover:disabled:opacity-50"),X(e,"!bg-ol-button-hover",t[1])},m(c,a){T(c,e,a),s&&s.m(e,null),l=!0,o||(i=[ae(e,"click",function(){ve(t[3])&&t[3].apply(this,arguments)}),ae(e,"mouseenter",t[6]),ae(e,"mouseleave",t[7])],o=!0)},p(c,[a]){t=c,s&&s.p&&(!l||a&16)&&lt(s,r,t,t[4],l?nt(r,t[4],a,null):ot(t[4]),null),(!l||a&1&&n!==(n=!t[0]))&&(e.disabled=n),(!l||a&4)&&g(e,"title",t[2]),a&2&&X(e,"!bg-ol-button-hover",t[1])},i(c){l||(C(s,c),l=!0)},o(c){O(s,c),l=!1},d(c){c&&S(e),s&&s.d(c),o=!1,ne(i)}}}function jn(t,e,n){let{$$slots:l={},$$scope:o}=e,{enabled:i=!0}=e,{active:r=!1}=e,{title:s}=e,{onClick:c}=e;function a(d){st.call(this,t,d)}function u(d){st.call(this,t,d)}return t.$$set=d=>{"enabled"in d&&n(0,i=d.enabled),"active"in d&&n(1,r=d.active),"title"in d&&n(2,s=d.title),"onClick"in d&&n(3,c=d.onClick),"$$scope"in d&&n(4,o=d.$$scope)},[i,r,s,c,o,l,a,u]}class Ue extends de{constructor(e){super(),ue(this,e,jn,An,le,{enabled:0,active:1,title:2,onClick:3})}}function wt(t,e,n){const l=t.slice();return l[15]=e[n],l}function yt(t){let e,n,l,o,i,r,s,c;n=new Ue({props:{active:t[3]===j.CREATE,enabled:t[4],title:"Create "+t[5]+" Features",onClick:t[10],$$slots:{default:[Rn]},$$scope:{ctx:t}}}),n.$on("mouseenter",t[11]);let a=t[6],u=[];for(let f=0;f<a.length;f+=1)u[f]=Et(wt(t,a,f));const d=f=>O(u[f],1,1,()=>{u[f]=null});return{c(){e=N("div"),H(n.$$.fragment),l=F(),o=N("div");for(let f=0;f<u.length;f+=1)u[f].c();g(o,"class",i=t[2]&&t[6].length>1?"flex":"hidden"),g(e,"class","flex")},m(f,h){T(f,e,h),V(n,e,null),E(e,l),E(e,o);for(let b=0;b<u.length;b+=1)u[b].m(o,null);r=!0,s||(c=ae(e,"mouseleave",t[13]),s=!0)},p(f,h){const b={};if(h&8&&(b.active=f[3]===j.CREATE),h&16&&(b.enabled=f[4]),h&32&&(b.title="Create "+f[5]+" Features"),h&262176&&(b.$$scope={dirty:h,ctx:f}),n.$set(b),h&736){a=f[6];let _;for(_=0;_<a.length;_+=1){const L=wt(f,a,_);u[_]?(u[_].p(L,h),C(u[_],1)):(u[_]=Et(L),u[_].c(),C(u[_],1),u[_].m(o,null))}for(ce(),_=a.length;_<u.length;_+=1)d(_);fe()}(!r||h&68&&i!==(i=f[2]&&f[6].length>1?"flex":"hidden"))&&g(o,"class",i)},i(f){if(!r){C(n.$$.fragment,f);for(let h=0;h<a.length;h+=1)C(u[h]);r=!0}},o(f){O(n.$$.fragment,f),u=u.filter(Boolean);for(let h=0;h<u.length;h+=1)O(u[h]);r=!1},d(f){f&&S(e),q(n),it(u,f),s=!1,c()}}}function Rn(t){let e,n;return e=new qe({props:{icon:t[7][t[5]],fw:!0,size:"sm",class:"mx-auto"}}),{c(){H(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p(l,o){const i={};o&32&&(i.icon=l[7][l[5]]),e.$set(i)},i(l){n||(C(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Fn(t){let e,n,l;return e=new qe({props:{icon:t[7][t[15]],fw:!0,size:"sm",class:"mx-auto"}}),{c(){H(e.$$.fragment),n=F()},m(o,i){V(e,o,i),T(o,n,i),l=!0},p(o,i){const r={};i&64&&(r.icon=o[7][o[15]]),e.$set(r)},i(o){l||(C(e.$$.fragment,o),l=!0)},o(o){O(e.$$.fragment,o),l=!1},d(o){q(e,o),o&&S(n)}}}function Et(t){let e,n;function l(...o){return t[12](t[15],...o)}return e=new Ue({props:{active:t[5]===t[15],title:t[15],onClick:l,$$slots:{default:[Fn]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(o,i){V(e,o,i),n=!0},p(o,i){t=o;const r={};i&96&&(r.active=t[5]===t[15]),i&64&&(r.title=t[15]),i&64&&(r.onClick=l),i&262208&&(r.$$scope={dirty:i,ctx:t}),e.$set(r)},i(o){n||(C(e.$$.fragment,o),n=!0)},o(o){O(e.$$.fragment,o),n=!1},d(o){q(e,o)}}}function vt(t){let e,n;return e=new Ue({props:{active:t[3]===j.EDIT,enabled:t[4],title:"Edit Features",onClick:t[14],$$slots:{default:[Mn]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p(l,o){const i={};o&8&&(i.active=l[3]===j.EDIT),o&16&&(i.enabled=l[4]),o&262144&&(i.$$scope={dirty:o,ctx:l}),e.$set(i)},i(l){n||(C(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Mn(t){let e,n;return e=new qe({props:{icon:Nn,fw:!0,size:"sm",class:"mx-auto"}}),{c(){H(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p:U,i(l){n||(C(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Gn(t){let e,n,l,o=t[0]&&yt(t),i=t[1]&&vt(t);return{c(){o&&o.c(),e=F(),i&&i.c(),n=rt()},m(r,s){o&&o.m(r,s),T(r,e,s),i&&i.m(r,s),T(r,n,s),l=!0},p(r,[s]){r[0]?o?(o.p(r,s),s&1&&C(o,1)):(o=yt(r),o.c(),C(o,1),o.m(e.parentNode,e)):o&&(ce(),O(o,1,1,()=>{o=null}),fe()),r[1]?i?(i.p(r,s),s&2&&C(i,1)):(i=vt(r),i.c(),C(i,1),i.m(n.parentNode,n)):i&&(ce(),O(i,1,1,()=>{i=null}),fe())},i(r){l||(C(o),C(i),l=!0)},o(r){O(o),O(i),l=!1},d(r){o&&o.d(r),r&&S(e),i&&i.d(r),r&&S(n)}}}function Dn(t,e,n){let l,o,i,r;J(t,ee,y=>n(3,l=y)),J(t,W,y=>n(4,o=y)),J(t,gn,y=>n(5,i=y)),J(t,_t,y=>n(6,r=y));const s={[D.POINT]:kn,[D.LINE_STRING]:Pn,[D.POLYGON]:Ln};let{create:c=!0}=e,{edit:a=!0}=e,u=!1;const d=(y,M)=>{y.blur(),ee.update(G=>{const p=G===M&&o?j.NONE:G===j.NONE||o?M:G;return console.log(G,M,"->",p),p})},f=(y,M)=>{y.blur(),ke.set(M),l!==j.CREATE&&d(y,j.CREATE)},h=y=>d(y.currentTarget,j.CREATE),b=()=>n(2,u=!0),_=(y,M)=>f(M.currentTarget,y),L=()=>n(2,u=!1),x=y=>d(y.currentTarget,j.EDIT);return t.$$set=y=>{"create"in y&&n(0,c=y.create),"edit"in y&&n(1,a=y.edit)},[c,a,u,l,o,i,r,s,d,f,h,b,_,L,x]}class Yn extends de{constructor(e){super(),ue(this,e,Dn,Gn,le,{create:0,edit:1})}}class zn extends Ke.default{constructor({position:e={},...n}){const l=document.createElement("div");l.className="ogc-api-crud-tools ol-unselectable ol-control flex flex-col",Object.keys(e).forEach(o=>{l.style[o]=e[o]}),new Yn({target:l,props:n}),super({element:l})}}function Vn(t){let e,n,l,o,i,r;const s=t[5].default,c=et(s,t,t[4],null);return{c(){e=N("button"),c&&c.c(),e.disabled=n=!t[0],g(e,"class",l=`px-4 py-1 text-sm text-white ${t[1]} disabled:${t[1]}/75 font-semibold rounded-full border border-transparent focus:outline-none hover:enabled:ring-2 ${t[2]} hover:enabled:ring-offset-2`)},m(a,u){T(a,e,u),c&&c.m(e,null),o=!0,i||(r=ae(e,"click",function(){ve(t[3])&&t[3].apply(this,arguments)}),i=!0)},p(a,[u]){t=a,c&&c.p&&(!o||u&16)&&lt(c,s,t,t[4],o?nt(s,t[4],u,null):ot(t[4]),null),(!o||u&1&&n!==(n=!t[0]))&&(e.disabled=n),(!o||u&6&&l!==(l=`px-4 py-1 text-sm text-white ${t[1]} disabled:${t[1]}/75 font-semibold rounded-full border border-transparent focus:outline-none hover:enabled:ring-2 ${t[2]} hover:enabled:ring-offset-2`))&&g(e,"class",l)},i(a){o||(C(c,a),o=!0)},o(a){O(c,a),o=!1},d(a){a&&S(e),c&&c.d(a),i=!1,r()}}}function qn(t,e,n){let{$$slots:l={},$$scope:o}=e,{enabled:i=!0}=e,{color:r="bg-slate-300"}=e,{ringColor:s="ring-slate-300"}=e,{onClick:c}=e;return t.$$set=a=>{"enabled"in a&&n(0,i=a.enabled),"color"in a&&n(1,r=a.color),"ringColor"in a&&n(2,s=a.ringColor),"onClick"in a&&n(3,c=a.onClick),"$$scope"in a&&n(4,o=a.$$scope)},[i,r,s,c,o,l]}class he extends de{constructor(e){super(),ue(this,e,qn,Vn,le,{enabled:0,color:1,ringColor:2,onClick:3})}}function Ot(t,e,n){const l=t.slice();return l[3]=e[n],l}function St(t){let e,n,l,o;function i(...r){return t[2](t[3],...r)}return{c(){e=N("input"),g(e,"type","text"),g(e,"class","w-full bg-transparent p-1 placeholder:italic placeholder:text-slate-400"),e.value=n=t[3].value,g(e,"placeholder","not set")},m(r,s){T(r,e,s),l||(o=ae(e,"input",i),l=!0)},p(r,s){t=r,s&1&&n!==(n=t[3].value)&&e.value!==n&&(e.value=n)},d(r){r&&S(e),l=!1,o()}}}function Tt(t){let e,n,l=t[3].label+"",o,i,r,s,c,a,u=t[3].isValue&&St(t);return{c(){e=N("tr"),n=N("td"),o=B(l),s=F(),c=N("td"),u&&u.c(),a=F(),g(n,"class",i=`w-1/3 p-1 pl-${t[3].depth*4}`),g(n,"title",r=t[3].name),g(e,"class","even:bg-slate-300/40"),X(e,"font-bold",t[3].isDirty)},m(d,f){T(d,e,f),E(e,n),E(n,o),E(e,s),E(e,c),u&&u.m(c,null),E(e,a)},p(d,f){f&1&&l!==(l=d[3].label+"")&&Oe(o,l),f&1&&i!==(i=`w-1/3 p-1 pl-${d[3].depth*4}`)&&g(n,"class",i),f&1&&r!==(r=d[3].name)&&g(n,"title",r),d[3].isValue?u?u.p(d,f):(u=St(d),u.c(),u.m(c,null)):u&&(u.d(1),u=null),f&1&&X(e,"font-bold",d[3].isDirty)},d(d){d&&S(e),u&&u.d()}}}function Un(t){let e,n=t[0],l=[];for(let o=0;o<n.length;o+=1)l[o]=Tt(Ot(t,n,o));return{c(){e=N("table");for(let o=0;o<l.length;o+=1)l[o].c();g(e,"class","w-full border-collapse text-sm")},m(o,i){T(o,e,i);for(let r=0;r<l.length;r+=1)l[r].m(e,null)},p(o,[i]){if(i&3){n=o[0];let r;for(r=0;r<n.length;r+=1){const s=Ot(o,n,r);l[r]?l[r].p(s,i):(l[r]=Tt(s),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=n.length}},i:U,o:U,d(o){o&&S(e),it(l,o)}}}function Hn(t,e,n){let{editables:l=[]}=e;const o=(r,s)=>{re.update((c={})=>({...c,[r]:s}))},i=(r,s)=>o(r.name,s.target.value);return t.$$set=r=>{"editables"in r&&n(0,l=r.editables)},[l,o,i]}class Jn extends de{constructor(e){super(),ue(this,e,Hn,Un,le,{editables:0})}}function Bn(t){let e;return{c(){e=B("Save")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Xn(t){let e;return{c(){e=B("Cancel")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Lt(t){let e,n;return e=new he({props:{color:"bg-red-600",ringColor:"ring-red-600",onClick:t[11],$$slots:{default:[Zn]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p(l,o){const i={};o&262144&&(i.$$scope={dirty:o,ctx:l}),e.$set(i)},i(l){n||(C(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Zn(t){let e;return{c(){e=B("Delete")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function It(t){let e;return{c(){e=N("div"),e.innerHTML='<div class="text-xl font-bold text-slate-500 animate-pulse">Saving...</div>',g(e,"id","ogc-api-editor-panel-overlay"),g(e,"class","bg-white/90 absolute w-full h-full flex justify-center items-center")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function kt(t){let e,n,l,o,i,r;return i=new he({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[14],$$slots:{default:[Kn]},$$scope:{ctx:t}}}),{c(){e=N("div"),n=N("div"),l=B(t[9]),o=F(),H(i.$$.fragment),g(n,"class","text-xl font-bold text-slate-500 text-center"),g(e,"id","ogc-api-editor-panel-error"),g(e,"class","bg-red-200/90 absolute w-full h-full flex flex-col gap-2 justify-center items-center")},m(s,c){T(s,e,c),E(e,n),E(n,l),E(e,o),V(i,e,null),r=!0},p(s,c){(!r||c&512)&&Oe(l,s[9]);const a={};c&262144&&(a.$$scope={dirty:c,ctx:s}),i.$set(a)},i(s){r||(C(i.$$.fragment,s),r=!0)},o(s){O(i.$$.fragment,s),r=!1},d(s){s&&S(e),q(i)}}}function Kn(t){let e;return{c(){e=B("Ok")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Nt(t){let e,n,l,o,i,r,s,c;return i=new he({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[15],$$slots:{default:[Qn]},$$scope:{ctx:t}}}),s=new he({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[16],$$slots:{default:[Wn]},$$scope:{ctx:t}}}),{c(){e=N("div"),n=N("div"),n.innerHTML=`The feature was changed by somebody else since you started to edit it.
        It will now be reloaded and you will be taken back to the editor.<br/>You can either discard your changes to see what was changed remotely
        or merge your changes on top of the reloaded feature which might hide
        the remote changes.`,l=F(),o=N("div"),H(i.$$.fragment),r=F(),H(s.$$.fragment),g(n,"class","text-base text-slate-500 text-center"),g(o,"class","flex flex-row gap-2"),g(e,"id","ogc-api-editor-panel-conflict"),g(e,"class","bg-amber-100/90 absolute w-full h-full flex flex-col gap-2 justify-around items-center p-2")},m(a,u){T(a,e,u),E(e,n),E(e,l),E(e,o),V(i,o,null),E(o,r),V(s,o,null),c=!0},p(a,u){const d={};u&2&&(d.onClick=a[15]),u&262144&&(d.$$scope={dirty:u,ctx:a}),i.$set(d);const f={};u&262144&&(f.$$scope={dirty:u,ctx:a}),s.$set(f)},i(a){c||(C(i.$$.fragment,a),C(s.$$.fragment,a),c=!0)},o(a){O(i.$$.fragment,a),O(s.$$.fragment,a),c=!1},d(a){a&&S(e),q(i),q(s)}}}function Qn(t){let e;return{c(){e=B("Discard my changes")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Wn(t){let e;return{c(){e=B("Merge my changes")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function $n(t){let e,n,l,o,i,r,s,c,a,u,d,f,h,b,_,L,x,y,M,G;u=new he({props:{color:"bg-sky-600",ringColor:"ring-sky-600",enabled:t[5],onClick:t[10],$$slots:{default:[Bn]},$$scope:{ctx:t}}}),f=new he({props:{onClick:bt,$$slots:{default:[Xn]},$$scope:{ctx:t}}});let p=t[6]===j.EDIT&&t[0]&&Lt(t);L=new Jn({props:{editables:t[7]}});let I=t[8]===Y.SYNC&&It(),P=t[8]===Y.ERROR&&kt(t),A=t[8]===Y.CONFLICT&&Nt(t);return{c(){e=N("div"),n=N("div"),l=N("div"),o=N("h3"),i=B(t[3]),r=F(),s=N("h3"),c=B(t[4]),a=F(),H(u.$$.fragment),d=F(),H(f.$$.fragment),h=F(),p&&p.c(),b=F(),_=N("div"),H(L.$$.fragment),x=F(),I&&I.c(),y=F(),P&&P.c(),M=F(),A&&A.c(),g(o,"id","ogc-api-editor-panel-header"),g(o,"class","text-lg font-bold text-slate-700"),g(s,"id","ogc-api-editor-panel-header2"),g(s,"class","text-base font-semibold text-slate-500"),g(l,"class","flex flex-col items-center border-b-2 border-slate-500 pb-2"),g(n,"id","ogc-api-editor-panel-main"),g(n,"class","flex flex-col justify-between py-2 px-4 min-w-[150px]"),g(_,"id","ogc-api-editor-panel-attributes"),g(_,"class","grow p-2 overflow-y-auto"),g(e,"id","ogc-api-editor-panel"),g(e,"class","ol-unselectable font-sans bg-white/90 text-slate-700 flex transform absolute bottom-0 left-0 w-full h-1/4 ease-in-out transition-transform duration-1000 pointer-events-auto"),X(e,"translate-y-full",t[2]),X(e,"translate-y-0",!t[2])},m(w,m){T(w,e,m),E(e,n),E(n,l),E(l,o),E(o,i),E(l,r),E(l,s),E(s,c),E(n,a),V(u,n,null),E(n,d),V(f,n,null),E(n,h),p&&p.m(n,null),E(e,b),E(e,_),V(L,_,null),E(e,x),I&&I.m(e,null),E(e,y),P&&P.m(e,null),E(e,M),A&&A.m(e,null),G=!0},p(w,[m]){(!G||m&8)&&Oe(i,w[3]),(!G||m&16)&&Oe(c,w[4]);const Je={};m&32&&(Je.enabled=w[5]),m&262144&&(Je.$$scope={dirty:m,ctx:w}),u.$set(Je);const Pt={};m&262144&&(Pt.$$scope={dirty:m,ctx:w}),f.$set(Pt),w[6]===j.EDIT&&w[0]?p?(p.p(w,m),m&65&&C(p,1)):(p=Lt(w),p.c(),C(p,1),p.m(n,null)):p&&(ce(),O(p,1,1,()=>{p=null}),fe());const At={};m&128&&(At.editables=w[7]),L.$set(At),w[8]===Y.SYNC?I||(I=It(),I.c(),I.m(e,y)):I&&(I.d(1),I=null),w[8]===Y.ERROR?P?(P.p(w,m),m&256&&C(P,1)):(P=kt(w),P.c(),C(P,1),P.m(e,M)):P&&(ce(),O(P,1,1,()=>{P=null}),fe()),w[8]===Y.CONFLICT?A?(A.p(w,m),m&256&&C(A,1)):(A=Nt(w),A.c(),C(A,1),A.m(e,null)):A&&(ce(),O(A,1,1,()=>{A=null}),fe()),m&4&&X(e,"translate-y-full",w[2]),m&4&&X(e,"translate-y-0",!w[2])},i(w){G||(C(u.$$.fragment,w),C(f.$$.fragment,w),C(p),C(L.$$.fragment,w),C(P),C(A),G=!0)},o(w){O(u.$$.fragment,w),O(f.$$.fragment,w),O(p),O(L.$$.fragment,w),O(P),O(A),G=!1},d(w){w&&S(e),q(u),q(f),p&&p.d(),q(L),I&&I.d(),P&&P.d(),A&&A.d()}}}function xn(t,e,n){let l,o,i,r,s,c,a,u;J(t,W,p=>n(2,l=p)),J(t,$,p=>n(3,o=p)),J(t,mt,p=>n(4,i=p)),J(t,pt,p=>n(5,r=p)),J(t,ee,p=>n(6,s=p)),J(t,hn,p=>n(7,c=p)),J(t,K,p=>n(8,a=p)),J(t,gt,p=>n(9,u=p));let{allowDelete:d}=e,{onSaveAsync:f}=e,{onDeleteAsync:h}=e;const b={},_=p=>p.then(I=>{I?(console.log("CONFLICT"),n(1,b.discard=I,b)):(console.log("CLEARING"),bt())}).catch(I=>{console.log("ERROR",I),gt.set(I.message),K.set(Y.ERROR)}),L=()=>(K.set(Y.SYNC),_(f())),x=()=>(K.set(Y.SYNC),_(h())),y=()=>K.set(Y.IDLE),M=()=>{b.discard(),K.set(Y.IDLE)},G=()=>{K.set(Y.IDLE)};return t.$$set=p=>{"allowDelete"in p&&n(0,d=p.allowDelete),"onSaveAsync"in p&&n(12,f=p.onSaveAsync),"onDeleteAsync"in p&&n(13,h=p.onDeleteAsync)},[d,b,l,o,i,r,s,c,a,u,L,x,f,h,y,M,G]}class el extends de{constructor(e){super(),ue(this,e,xn,$n,le,{allowDelete:0,onSaveAsync:12,onDeleteAsync:13})}}class tl extends Ke.default{constructor({map:e,...n}){const l=e.getOverlayContainerStopEvent();new el({target:l,props:n}),super({})}setMap(e){e.render()}}var ol="";const He=(t=1e3)=>new Promise(e=>setTimeout(e,t));class nl{constructor({api:e={},tools:n={},dryRun:l=!1}={}){this.api={crs:"http://www.opengis.net/def/crs/OGC/1.3/CRS84",styleFunction:void 0,token:void 0,...e,schemas:{custom:null,create:"schema?type=create",replace:"schema?type=replace",update:"schema?type=update",...e.schemas||{}},capabilities:{crs:!1,patch:!1,maxAllowableOffset:!1,...e.capabilities||{}}},this.tools={create:!0,edit:!0,delete:!0,initial:"CREATE",position:{top:"5rem",left:"0.5rem"},styleFunction:void 0,styleOptions:{color:"red",strokeWidth:2,circleRadius:5,fillOpacity:""},...n},this.tools.styleFunction||(this.tools.styleFunction=Cn(this.tools.styleOptions)),this.dryRun=l}addToMap(e){const{url:n,collections:l,crs:o,styleFunction:i,token:r}=this.api,s=l[0],c={[s]:{id:s,crs:o}};$.set(s);const a=Object.values(c).map(f=>Qt(n,f.id,this.api.schemas,r).then(h=>{console.log(h);const b=ze(h.properties.properties,h.$defs);console.log(b);let _=dt(h.properties.geometry,h.$defs);_.includes(D.MULTI_POINT)&&_.splice(_.indexOf(D.MULTI_POINT),1,D.POINT),_.includes(D.MULTI_LINE_STRING)&&_.splice(_.indexOf(D.MULTI_LINE_STRING),1,D.LINE_STRING),_.includes(D.MULTI_POLYGON)&&_.splice(_.indexOf(D.MULTI_POLYGON),1,D.POLYGON),_=[...new Set(_)],console.log(_),_.length>0&&ke.update(L=>L||_[0]),Ae.update(L=>({...L,[f.id]:{...f,label:h.title,properties:b.properties,geoTypes:_}}))}));Promise.all(a).then(f=>console.log("INITIALIZED",f));const u=this.items=an(n,s,1e3,o,i,r),d=cn(o,this.tools.styleFunction,e.getView().getProjection());e.addControl(new zn(this.tools)),e.addControl(new tl({map:e,allowDelete:this.tools.delete,onSaveAsync:()=>{const f=dn(e.getView().getProjection(),o,this.api.capabilities.patch);return this._syncChanges(f)},onDeleteAsync:this._deleteFeature.bind(this)})),e.addInteraction(_n(d.getSource())),this.tools.create&&e.getInteractions().extend(bn(d.getSource(),c[s])),this.tools.edit&&(e.addInteraction(mn(d.getSource())),e.addInteraction(pn(n,c,u.getSource(),this.api.schemas.custom==="schemas/replace"?"schema=receivables":"",this.api.token))),e.addLayer(u),e.addLayer(d),this.geoJson=un(e.getView().getProjection(),o)}_syncChanges(e){if(console.log("_syncChanges"),k(pt)){const n=k(Ae)[k($)];return k(ee)===j.CREATE?this.dryRun?(console.log("POST",n.id,e),He()):Bt(this.api.url,n.id,e,this.api.crs,this.api.token).then(o=>{console.log("id",o);const i=this.geoJson.readFeature({...e,id:o});this.items.getSource().addFeature(i)}):this.dryRun?(console.log(this.api.capabilities.patch?"PATCH":"PUT",n.id,e.id,e),He()):(this.api.capabilities.patch?Zt:Xt)(this.api.url,n.id,e,this.api.crs,k(Pe),this.api.token).then(()=>{const o=this.geoJson.readFeature(e);this.items.getSource().addFeature(o)}).catch(o=>{if(o.message.indexOf("412")===0){const i=()=>{ie.set(void 0),re.set(void 0)};return Qe(this.api.url,n.id,e.id,n.crs,this.api.schemas.custom==="schemas/replace"?"schema=receivables":"",this.api.token).then(r=>(Z.set(r.feature),Pe.set(r.etag),K.set(Y.CONFLICT),i))}else throw o})}return Promise.resolve()}_deleteFeature(){if(k(Z))return Ce.set(void 0),this.dryRun?(console.log("DELETE",k($),k(Z).id),He()):Kt(this.api.url,k($),k(Z).id,this.api.token).then(()=>{})}}return nl});
