(function(j,he){typeof exports=="object"&&typeof module!="undefined"?module.exports=he(require("ol/interaction/Draw"),require("ol/interaction/Modify"),require("ol/interaction/Snap"),require("ol/interaction/Interaction"),require("ol/format/GeoJSON"),require("ol/source/Vector"),require("ol/layer/Vector"),require("ol/proj/Projection"),require("ol/loadingstrategy"),require("ol/tilegrid"),require("ol/style"),require("ol/geom"),require("ol/control/Control")):typeof define=="function"&&define.amd?define(["ol/interaction/Draw","ol/interaction/Modify","ol/interaction/Snap","ol/interaction/Interaction","ol/format/GeoJSON","ol/source/Vector","ol/layer/Vector","ol/proj/Projection","ol/loadingstrategy","ol/tilegrid","ol/style","ol/geom","ol/control/Control"],he):(j=typeof globalThis!="undefined"?globalThis:j||self,j.OgcApiEditor=he(j.ol.interaction.Draw,j.ol.interaction.Modify,j.ol.interaction.Snap,j.ol.interaction.Interaction,j.ol.format.GeoJSON,j.ol.source.Vector,j.ol.layer.Vector,j.ol.proj.Projection,j.ol.loadingstrategy,j.ol.tilegrid,j.ol.style,j.ol.geom,j.ol.control.Control))})(this,function(j,he,At,jt,Rt,Ft,Gt,Mt,Dt,Yt,v,we,Vt){"use strict";function Q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var zt=Q(j),qt=Q(he),Ut=Q(At),Ht=Q(jt),Ce=Q(Rt),Je=Q(Ft),Be=Q(Gt),Xe=Q(Mt),Ze=Q(Vt);const Ke=(t,e,n,l,o)=>fetch(`${t}/collections/${e}/items/${n}?${o}${l?"&crs="+l:""}`,{headers:{Accept:"application/geo+json"}}).then(Qe(!0)),Jt=(t,e,n,l)=>fetch(`${t}/collections/${e}/items`,{headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`},method:"POST",body:JSON.stringify(n)}).then(Ae).then(Kt),Bt=(t,e,n,l,o)=>{const r={"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`,Accept:"application/json"};return o&&(r["If-Match"]=o),fetch(`${t}/collections/${e}/items/${n.id}`,{headers:r,method:"PUT",body:JSON.stringify(n)}).then(Ae)},Xt=(t,e,n)=>fetch(`${t}/collections/${e}/items/${n}`,{method:"DELETE"}).then(Ae),Zt=(t,e,n)=>{const l=n&&n.custom||n.replace;return fetch(`${t}/collections/${e}/${l}`,{headers:{Accept:"application/schema+json"}}).then(Qe(!1))},Qe=t=>e=>(console.log("ETag",e.headers.get("etag")),e&&e.ok?e.json().then(n=>t?{feature:n,etag:e.headers.get("etag")}:n):t?{feature:{},etag:e.headers.get("etag")}:{}),Kt=t=>t&&t.ok?t.headers.get("location").substr(t.headers.get("location").lastIndexOf("/")+1):void 0,Ae=t=>{if(t.ok)return t;if(t.bodyUsed)return t.json().then(e=>{je(t,e.detail)}).catch(()=>{je(t)});je(t)},je=(t,e)=>{t.status;let n=t.status+" "+t.statusText;throw e&&(n+="<br/>"+e),new Error(n)},A={NONE:"NONE",CREATE:"CREATE",EDIT:"EDIT"},D={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},Y={IDLE:"IDLE",SYNC:"SYNC",SUCCESS:"SUCCESS",ERROR:"ERROR",CONFLICT:"CONFLICT"};class Qt extends Ht.default{constructor(e){super();const n=e||{};this._onSelect=n.onSelect||null,this._collections=n._collections||[]}handleEvent(e){let n=!1;if(e.type==="click"){const l=e.map,o=[];l.forEachFeatureAtPixel(e.pixel,(r,i)=>{o.push({feature:r,layer:i.get("collection")})},{layerFilter:r=>this._collections.length===0||this._collections.includes(r.get("collection"))}),o.length>0&&(this.setActive(!1),this._onSelect(o)),n=!0}return!n}}function U(){}function Wt(t,e){for(const n in e)t[n]=e[n];return t}function We(t){return t()}function $e(){return Object.create(null)}function te(t){t.forEach(We)}function ye(t){return typeof t=="function"}function ne(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function $t(t){return Object.keys(t).length===0}function Re(t,...e){if(t==null)return U;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function P(t){let e;return Re(t,n=>e=n)(),e}function J(t,e,n){t.$$.on_destroy.push(Re(e,n))}function xe(t,e,n,l){if(t){const o=et(t,e,n,l);return t[0](o)}}function et(t,e,n,l){return t[1]&&l?Wt(n.ctx.slice(),t[1](l(e))):n.ctx}function tt(t,e,n,l){if(t[2]&&l){const o=t[2](l(n));if(e.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(e.dirty.length,o.length);for(let s=0;s<i;s+=1)r[s]=e.dirty[s]|o[s];return r}return e.dirty|o}return e.dirty}function nt(t,e,n,l,o,r){if(o){const i=et(e,n,l,r);t.p(i,o)}}function lt(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function E(t,e){t.appendChild(e)}function T(t,e,n){t.insertBefore(e,n||null)}function S(t){t.parentNode.removeChild(t)}function ot(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function I(t){return document.createElement(t)}function ie(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function B(t){return document.createTextNode(t)}function F(){return B(" ")}function rt(){return B("")}function se(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function xt(t){return Array.from(t.childNodes)}function Ee(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function X(t,e,n){t.classList[n?"add":"remove"](e)}let Fe;function me(t){Fe=t}function it(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(l=>l.call(this,e))}const _e=[],st=[],ve=[],at=[],en=Promise.resolve();let Ge=!1;function tn(){Ge||(Ge=!0,en.then(ft))}function Me(t){ve.push(t)}const De=new Set;let Oe=0;function ft(){const t=Fe;do{for(;Oe<_e.length;){const e=_e[Oe];Oe++,me(e),nn(e.$$)}for(me(null),_e.length=0,Oe=0;st.length;)st.pop()();for(let e=0;e<ve.length;e+=1){const n=ve[e];De.has(n)||(De.add(n),n())}ve.length=0}while(_e.length);for(;at.length;)at.pop()();Ge=!1,De.clear(),me(t)}function nn(t){if(t.fragment!==null){t.update(),te(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Me)}}const Se=new Set;let le;function ae(){le={r:0,c:[],p:le}}function fe(){le.r||te(le.c),le=le.p}function w(t,e){t&&t.i&&(Se.delete(t),t.i(e))}function O(t,e,n,l){if(t&&t.o){if(Se.has(t))return;Se.add(t),le.c.push(()=>{Se.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function H(t){t&&t.c()}function z(t,e,n,l){const{fragment:o,on_mount:r,on_destroy:i,after_update:s}=t.$$;o&&o.m(e,n),l||Me(()=>{const f=r.map(We).filter(ye);i?i.push(...f):te(f),t.$$.on_mount=[]}),s.forEach(Me)}function q(t,e){const n=t.$$;n.fragment!==null&&(te(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ln(t,e){t.$$.dirty[0]===-1&&(_e.push(t),tn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ce(t,e,n,l,o,r,i,s=[-1]){const f=Fe;me(t);const a=t.$$={fragment:null,ctx:null,props:r,update:U,not_equal:o,bound:$e(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:$e(),dirty:s,skip_bound:!1,root:e.target||f.$$.root};i&&i(a.root);let d=!1;if(a.ctx=n?n(t,e.props||{},(u,c,...h)=>{const _=h.length?h[0]:c;return a.ctx&&o(a.ctx[u],a.ctx[u]=_)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](_),d&&ln(t,u)),c}):[],a.update(),d=!0,te(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){const u=xt(e.target);a.fragment&&a.fragment.l(u),u.forEach(S)}else a.fragment&&a.fragment.c();e.intro&&w(t.$$.fragment),z(t,e.target,e.anchor,e.customElement),ft()}me(f)}class ue{$destroy(){q(this,1),this.$destroy=U}$on(e,n){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!$t(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const de=[];function on(t,e){return{subscribe:V(t,e).subscribe}}function V(t,e=U){let n;const l=new Set;function o(s){if(ne(t,s)&&(t=s,n)){const f=!de.length;for(const a of l)a[1](),de.push(a,t);if(f){for(let a=0;a<de.length;a+=2)de[a][0](de[a+1]);de.length=0}}}function r(s){o(s(t))}function i(s,f=U){const a=[s,f];return l.add(a),l.size===1&&(n=e(o)||U),s(t),()=>{l.delete(a),l.size===0&&(n(),n=null)}}return{set:o,update:r,subscribe:i}}function be(t,e,n){const l=!Array.isArray(t),o=l?[t]:t,r=e.length<2;return on(n,i=>{let s=!1;const f=[];let a=0,d=U;const u=()=>{if(a)return;d();const h=e(l?f[0]:f,i);r?i(h):d=ye(h)?h:U},c=o.map((h,_)=>Re(h,p=>{f[_]=p,a&=~(1<<_),s&&u()},()=>{a|=1<<_}));return s=!0,u(),function(){te(c),d()}})}const rn=(t,e,n,l,o)=>{const r=new Je.default({format:new Ce.default({dataProjection:Te(l)}),loader:function(s,f,a,d,u){const c=`${t}/collections/${e}/items?f=json&limit=${n}&bbox=`+s[0]+","+s[1]+","+s[2]+","+s[3]+"&bbox-crs="+encodeURIComponent(an(a))+"&crs="+encodeURIComponent(l);fetch(c).then(h=>h.ok?h.json().then(_=>{var p=r.getFormat().readFeatures(_,{featureProjection:a});r.addFeatures(p),d(p)}):h.text().then(_=>u(`${h.status} ${h.statusText} - ${_}`)))},strategy:Dt.tile(Yt.createXYZ({tileSize:512}))});return new Be.default({source:r,properties:{collection:e},style:o})},sn=(t,e,n)=>{const l=new Ce.default({dataProjection:Te(t)}),o=new Je.default({});return K.subscribe(r=>{if(r){const i=l.readFeature(r,{featureProjection:n});o.addFeature(i)}else o.clear()}),W.subscribe(r=>{r&&o.clear()}),new Be.default({source:o,style:e})},an=t=>t.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),Te=t=>t==="http://www.opengis.net/def/crs/OGC/1.3/CRS84"?new Xe.default({code:"EPSG:4326",axisOrientation:"neu"}):new Xe.default({code:t.replace("http://www.opengis.net/def/crs/EPSG/0/","EPSG:")}),ct=(t,e,n={},l=1,o="")=>Object.keys(t).flatMap(r=>t[r].type==="object"?[{name:o+r,label:t[r].title||r,isValue:!1,depth:l}].concat(ct(t[r].properties,e[r]||{},n,l+1,o+r+".")):{name:o+r,label:t[r].title||r,value:n[o+r]||e[r]||"",isDirty:n[o+r]&&n[o+r]!==e[r],isValue:!0,depth:l}),Ye=(t,e)=>{const n={...t};if(n.properties){const l=n.properties;Object.keys(l).forEach(o=>{l[o].$ref&&l[o].$ref.includes("$defs")&&(l[o]=e[l[o].$ref.substr(8)]),l[o].type==="object"&&(l[o]=Ye(l[o],e)),l[o].type==="array"&&delete l[o]})}return n},ut=(t,e)=>{const n=Ye(t,e),l=[];return n.properties&&n.properties.type&&n.properties.type.enum&&l.push(...n.properties.type.enum),n.oneOf&&n.oneOf.forEach(o=>{o.type==="object"&&l.push(...ut(o,e))}),l},fn=(t,e)=>new Ce.default({featureProjection:t,dataProjection:Te(e)}),cn=(t,e)=>{const n=P(ee)===A.CREATE?{type:"Feature",properties:{}}:P(K);if(P(oe)){const l=new Ce.default({featureProjection:t,dataProjection:Te(e)});n.geometry=l.writeGeometryObject(P(oe),{rightHanded:!0,decimals:10})}if(P(re)){const l=P(re),o={...n.properties};Object.keys(l).forEach(r=>{const i=r.split(".");let s=o;for(let f=0;f<i.length-1;f++)s[i[f]]||(s[i[f]]={}),s=s[i[f]];s[i[i.length-1]]=l[r]}),n.properties=o}return n},ee=V(A.NONE),Z=V(Y.IDLE),Le=V(),W=V(!0),dt=V(),gt=be([ee,Z,Le,W],([t,e,n,l])=>({tool:t,sync:e,geo:n,panelOff:l})),pe=V(),Ie=V(),K=V(),Ne=V(),ke=V(),$=V(""),ht=V(""),oe=V(),re=V(),mt=be([ke,$],([t,e])=>t&&t[e]?t[e].geoTypes:[]),un=be([Le,mt],([t,e])=>t&&e.includes(t)?t:e.length>0?e[0]:!1),_t=be([ee,K,oe,re],([t,e,n,l])=>{const o=t===A.CREATE||e&&n;if(!o&&e&&l){const r=e.properties,i=l;return Object.keys(i).some(s=>i[s]!==r[s])}return o}),dn=be([ke,$,K,re,ee,W],([t,e,n,l,o,r])=>!r&&t&&t[e]&&(n||o===A.CREATE)?ct(t[e].properties,n&&n.properties||{},l):[]),bt=()=>{P(Ie)&&P(pe)&&P(pe)(P(Ie)),Ne.set(void 0),Ie.set(void 0),K.set(void 0),pe.set(void 0),oe.set(void 0),re.set(void 0),Z.set(Y.IDLE),W.set(!0)},gn=t=>{const e=new qt.default({source:t});return e.on("modifyend",n=>{n.features&&n.features.getLength()>0&&(console.log("mod",n.features.item(0).getGeometry().getRevision()),oe.set(n.features.item(0).getGeometry()))}),W.subscribe(n=>{console.log("MODIFY",!n),e.setActive(!n)}),e},hn=t=>new Ut.default({source:t}),mn=(t,e,n,l)=>{const o=new Qt({collections:Object.keys(e),onSelect:r=>{const i=r[0],s=e[i.layer],f=i.feature.getId();Ie.set(i.feature),pe.set(a=>n.addFeature(a)),n.removeFeature(i.feature),Ke(t,s.id,f,s.crs,l).then(a=>{$.set(s.id),ht.set(a.feature.id),K.set(a.feature),Ne.set(a.etag),W.set(!1)})}});return o.setActive(!1),gt.subscribe(r=>{o.setActive(r.panelOff&&r.tool===A.EDIT)}),o},_n=(t,e)=>{const n={};return[D.POINT,D.LINE_STRING,D.POLYGON].forEach(l=>{const o=new zt.default({source:t,type:l});o.setActive(!1),o.on("drawend",r=>{console.log(r.feature.getGeometry().getRevision()),$.set(e.id),W.set(!1),oe.set(r.feature.getGeometry())}),n[l]=o}),gt.subscribe(l=>{Object.keys(n).forEach(o=>{n[o].setActive(l.geo===o&&l.tool===A.CREATE&&l.panelOff)})}),Object.values(n)},bn=({color:t,strokeWidth:e,circleRadius:n,fillOpacity:l})=>{const o={Point:new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})})}),LineString:[new v.Style({stroke:new v.Stroke({color:t,width:e})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates();return new we.MultiPoint(i)}})],MultiLineString:new v.Style({stroke:new v.Stroke({color:t,width:e})}),MultiPoint:[new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates().reduce((s,f)=>s.concat(f),[]);return new we.MultiPoint(i)}})],MultiPolygon:[new v.Style({stroke:new v.Stroke({color:t,width:e}),fill:new v.Fill({color:"rgba(255, 0, 0, 0.5)"})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates().reduce((s,f)=>s.concat(f[0]),[]);return new we.MultiPoint(i)}})],Polygon:[new v.Style({stroke:new v.Stroke({color:t,width:e}),fill:new v.Fill({color:"rgba(255, 0, 0, 0.5)"})}),new v.Style({image:new v.Circle({radius:n,fill:new v.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates().reduce((s,f)=>s.concat(f),[]);return new we.MultiPoint(i)}})]};return r=>o[r.getGeometry().getType()]},Pe=parseFloat;function Ve(t,e=";"){let n;if(Array.isArray(t))n=t.filter(l=>l);else{n=[];for(const l in t)t[l]&&n.push(`${l}:${t[l]}`)}return n.join(e)}function pn(t,e,n,l){let o,r;const i="1em";let s,f,a,d="-.125em";const u="visible";return l&&(a="center",r="1.25em"),n&&(o=n),e&&(e=="lg"?(f="1.33333em",s=".75em",d="-.225em"):e=="xs"?f=".75em":e=="sm"?f=".875em":f=e.replace("x","em")),Ve([Ve({float:o,width:r,height:i,"line-height":s,"font-size":f,"text-align":a,"vertical-align":d,"transform-origin":"center",overflow:u}),t])}function wn(t,e,n,l,o,r=1,i="",s=""){let f=1,a=1;return o&&(o=="horizontal"?f=-1:o=="vertical"?a=-1:f=a=-1),Ve([`translate(${Pe(e)*r}${i},${Pe(n)*r}${i})`,`scale(${f*Pe(t)},${a*Pe(t)})`,l&&`rotate(${l}${s})`]," ")}var tl="";function pt(t){let e,n,l,o,r,i,s,f;function a(c,h){return typeof c[10][4]=="string"?yn:Cn}let d=a(t),u=d(t);return{c(){e=ie("svg"),n=ie("g"),l=ie("g"),u.c(),g(l,"transform",t[12]),g(n,"transform",o="translate("+t[10][0]/2+" "+t[10][1]/2+")"),g(n,"transform-origin",r=t[10][0]/4+" 0"),g(e,"id",i=t[1]||void 0),g(e,"class",s="svelte-fa "+t[0]+" svelte-1w3t65e"),g(e,"style",t[11]),g(e,"viewBox",f="0 0 "+t[10][0]+" "+t[10][1]),g(e,"aria-hidden","true"),g(e,"role","img"),g(e,"xmlns","http://www.w3.org/2000/svg"),X(e,"pulse",t[4]),X(e,"spin",t[3])},m(c,h){T(c,e,h),E(e,n),E(n,l),u.m(l,null)},p(c,h){d===(d=a(c))&&u?u.p(c,h):(u.d(1),u=d(c),u&&(u.c(),u.m(l,null))),h&4096&&g(l,"transform",c[12]),h&1024&&o!==(o="translate("+c[10][0]/2+" "+c[10][1]/2+")")&&g(n,"transform",o),h&1024&&r!==(r=c[10][0]/4+" 0")&&g(n,"transform-origin",r),h&2&&i!==(i=c[1]||void 0)&&g(e,"id",i),h&1&&s!==(s="svelte-fa "+c[0]+" svelte-1w3t65e")&&g(e,"class",s),h&2048&&g(e,"style",c[11]),h&1024&&f!==(f="0 0 "+c[10][0]+" "+c[10][1])&&g(e,"viewBox",f),h&17&&X(e,"pulse",c[4]),h&9&&X(e,"spin",c[3])},d(c){c&&S(e),u.d()}}}function Cn(t){let e,n,l,o,r,i,s,f,a,d;return{c(){e=ie("path"),i=ie("path"),g(e,"d",n=t[10][4][0]),g(e,"fill",l=t[6]||t[2]||"currentColor"),g(e,"fill-opacity",o=t[9]!=!1?t[7]:t[8]),g(e,"transform",r="translate("+t[10][0]/-2+" "+t[10][1]/-2+")"),g(i,"d",s=t[10][4][1]),g(i,"fill",f=t[5]||t[2]||"currentColor"),g(i,"fill-opacity",a=t[9]!=!1?t[8]:t[7]),g(i,"transform",d="translate("+t[10][0]/-2+" "+t[10][1]/-2+")")},m(u,c){T(u,e,c),T(u,i,c)},p(u,c){c&1024&&n!==(n=u[10][4][0])&&g(e,"d",n),c&68&&l!==(l=u[6]||u[2]||"currentColor")&&g(e,"fill",l),c&896&&o!==(o=u[9]!=!1?u[7]:u[8])&&g(e,"fill-opacity",o),c&1024&&r!==(r="translate("+u[10][0]/-2+" "+u[10][1]/-2+")")&&g(e,"transform",r),c&1024&&s!==(s=u[10][4][1])&&g(i,"d",s),c&36&&f!==(f=u[5]||u[2]||"currentColor")&&g(i,"fill",f),c&896&&a!==(a=u[9]!=!1?u[8]:u[7])&&g(i,"fill-opacity",a),c&1024&&d!==(d="translate("+u[10][0]/-2+" "+u[10][1]/-2+")")&&g(i,"transform",d)},d(u){u&&S(e),u&&S(i)}}}function yn(t){let e,n,l,o;return{c(){e=ie("path"),g(e,"d",n=t[10][4]),g(e,"fill",l=t[2]||t[5]||"currentColor"),g(e,"transform",o="translate("+t[10][0]/-2+" "+t[10][1]/-2+")")},m(r,i){T(r,e,i)},p(r,i){i&1024&&n!==(n=r[10][4])&&g(e,"d",n),i&36&&l!==(l=r[2]||r[5]||"currentColor")&&g(e,"fill",l),i&1024&&o!==(o="translate("+r[10][0]/-2+" "+r[10][1]/-2+")")&&g(e,"transform",o)},d(r){r&&S(e)}}}function En(t){let e,n=t[10][4]&&pt(t);return{c(){n&&n.c(),e=rt()},m(l,o){n&&n.m(l,o),T(l,e,o)},p(l,[o]){l[10][4]?n?n.p(l,o):(n=pt(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:U,o:U,d(l){n&&n.d(l),l&&S(e)}}}function vn(t,e,n){let{class:l=""}=e,{id:o=""}=e,{style:r=""}=e,{icon:i}=e,{size:s=""}=e,{color:f=""}=e,{fw:a=!1}=e,{pull:d=""}=e,{scale:u=1}=e,{translateX:c=0}=e,{translateY:h=0}=e,{rotate:_=""}=e,{flip:p=!1}=e,{spin:R=!1}=e,{pulse:x=!1}=e,{primaryColor:y=""}=e,{secondaryColor:G=""}=e,{primaryOpacity:M=1}=e,{secondaryOpacity:b=.4}=e,{swapOpacity:L=!1}=e,N,k,C;return t.$$set=m=>{"class"in m&&n(0,l=m.class),"id"in m&&n(1,o=m.id),"style"in m&&n(13,r=m.style),"icon"in m&&n(14,i=m.icon),"size"in m&&n(15,s=m.size),"color"in m&&n(2,f=m.color),"fw"in m&&n(16,a=m.fw),"pull"in m&&n(17,d=m.pull),"scale"in m&&n(18,u=m.scale),"translateX"in m&&n(19,c=m.translateX),"translateY"in m&&n(20,h=m.translateY),"rotate"in m&&n(21,_=m.rotate),"flip"in m&&n(22,p=m.flip),"spin"in m&&n(3,R=m.spin),"pulse"in m&&n(4,x=m.pulse),"primaryColor"in m&&n(5,y=m.primaryColor),"secondaryColor"in m&&n(6,G=m.secondaryColor),"primaryOpacity"in m&&n(7,M=m.primaryOpacity),"secondaryOpacity"in m&&n(8,b=m.secondaryOpacity),"swapOpacity"in m&&n(9,L=m.swapOpacity)},t.$$.update=()=>{t.$$.dirty&16384&&n(10,N=i&&i.icon||[0,0,"",[],""]),t.$$.dirty&237568&&n(11,k=pn(r,s,d,a)),t.$$.dirty&8126464&&n(12,C=wn(u,c,h,_,p,512))},[l,o,f,R,x,y,G,M,b,L,N,k,C,r,i,s,a,d,u,c,h,_,p]}class On extends ue{constructor(e){super(),ce(this,e,vn,En,ne,{class:0,id:1,style:13,icon:14,size:15,color:2,fw:16,pull:17,scale:18,translateX:19,translateY:20,rotate:21,flip:22,spin:3,pulse:4,primaryColor:5,secondaryColor:6,primaryOpacity:7,secondaryOpacity:8,swapOpacity:9})}}var ze=On;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var Sn={prefix:"fas",iconName:"draw-polygon",icon:[448,512,[],"f5ee","M384.3 352C419.5 352.2 448 380.7 448 416C448 451.3 419.3 480 384 480C360.3 480 339.6 467.1 328.6 448H119.4C108.4 467.1 87.69 480 64 480C28.65 480 0 451.3 0 416C0 392.3 12.87 371.6 32 360.6V151.4C12.87 140.4 0 119.7 0 96C0 60.65 28.65 32 64 32C87.69 32 108.4 44.87 119.4 64H328.6C339.6 44.87 360.3 32 384 32C419.3 32 448 60.65 448 96C448 131.3 419.5 159.8 384.3 159.1L345.5 227.9C349.7 236.4 352 245.9 352 256C352 266.1 349.7 275.6 345.5 284.1L384.3 352zM96 360.6C105.7 366.2 113.8 374.3 119.4 384H328.6C328.6 383.9 328.7 383.8 328.7 383.7L292.2 319.9C290.8 319.1 289.4 320 288 320C252.7 320 224 291.3 224 256C224 220.7 252.7 192 288 192C289.4 192 290.8 192 292.2 192.1L328.7 128.3L328.6 128H119.4C113.8 137.7 105.7 145.8 96 151.4L96 360.6z"]},Tn={prefix:"fas",iconName:"location-pin",icon:[384,512,["map-marker"],"f041","M384 192C384 279.4 267 435 215.7 499.2C203.4 514.5 180.6 514.5 168.3 499.2C116.1 435 0 279.4 0 192C0 85.96 85.96 0 192 0C298 0 384 85.96 384 192H384z"]},Ln=Tn,In={prefix:"fas",iconName:"pencil",icon:[512,512,[61504,9999,"pencil-alt"],"f303","M421.7 220.3L188.5 453.4L154.6 419.5L158.1 416H112C103.2 416 96 408.8 96 400V353.9L92.51 357.4C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6L137.6 429.6C143.1 427.7 149.8 424.2 154.6 419.5L188.5 453.4C178.1 463.8 165.2 471.5 151.1 475.6L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1C.8198 498.8-1.502 489.7 .976 481.2L36.37 360.9C40.53 346.8 48.16 333.9 58.57 323.5L291.7 90.34L421.7 220.3zM492.7 58.75C517.7 83.74 517.7 124.3 492.7 149.3L444.3 197.7L314.3 67.72L362.7 19.32C387.7-5.678 428.3-5.678 453.3 19.32L492.7 58.75z"]},Nn={prefix:"fas",iconName:"slash",icon:[640,512,[],"f715","M5.112 9.196C13.29-1.236 28.37-3.065 38.81 5.112L630.8 469.1C641.2 477.3 643.1 492.4 634.9 502.8C626.7 513.2 611.6 515.1 601.2 506.9L9.196 42.89C-1.236 34.71-3.065 19.63 5.112 9.196V9.196z"]};function kn(t){let e,n,l,o,r;const i=t[5].default,s=xe(i,t,t[4],null);return{c(){e=I("button"),s&&s.c(),e.disabled=n=!t[0],g(e,"title",t[2]),g(e,"class","disabled:opacity-70 hover:disabled:opacity-50"),X(e,"!bg-ol-button-hover",t[1])},m(f,a){T(f,e,a),s&&s.m(e,null),l=!0,o||(r=[se(e,"click",function(){ye(t[3])&&t[3].apply(this,arguments)}),se(e,"mouseenter",t[6]),se(e,"mouseleave",t[7])],o=!0)},p(f,[a]){t=f,s&&s.p&&(!l||a&16)&&nt(s,i,t,t[4],l?tt(i,t[4],a,null):lt(t[4]),null),(!l||a&1&&n!==(n=!t[0]))&&(e.disabled=n),(!l||a&4)&&g(e,"title",t[2]),a&2&&X(e,"!bg-ol-button-hover",t[1])},i(f){l||(w(s,f),l=!0)},o(f){O(s,f),l=!1},d(f){f&&S(e),s&&s.d(f),o=!1,te(r)}}}function Pn(t,e,n){let{$$slots:l={},$$scope:o}=e,{enabled:r=!0}=e,{active:i=!1}=e,{title:s}=e,{onClick:f}=e;function a(u){it.call(this,t,u)}function d(u){it.call(this,t,u)}return t.$$set=u=>{"enabled"in u&&n(0,r=u.enabled),"active"in u&&n(1,i=u.active),"title"in u&&n(2,s=u.title),"onClick"in u&&n(3,f=u.onClick),"$$scope"in u&&n(4,o=u.$$scope)},[r,i,s,f,o,l,a,d]}class qe extends ue{constructor(e){super(),ce(this,e,Pn,kn,ne,{enabled:0,active:1,title:2,onClick:3})}}function wt(t,e,n){const l=t.slice();return l[15]=e[n],l}function Ct(t){let e,n,l,o,r,i,s,f;n=new qe({props:{active:t[3]===A.CREATE,enabled:t[4],title:"Create "+t[5]+" Features",onClick:t[10],$$slots:{default:[An]},$$scope:{ctx:t}}}),n.$on("mouseenter",t[11]);let a=t[6],d=[];for(let c=0;c<a.length;c+=1)d[c]=yt(wt(t,a,c));const u=c=>O(d[c],1,1,()=>{d[c]=null});return{c(){e=I("div"),H(n.$$.fragment),l=F(),o=I("div");for(let c=0;c<d.length;c+=1)d[c].c();g(o,"class",r=t[2]&&t[6].length>1?"flex":"hidden"),g(e,"class","flex")},m(c,h){T(c,e,h),z(n,e,null),E(e,l),E(e,o);for(let _=0;_<d.length;_+=1)d[_].m(o,null);i=!0,s||(f=se(e,"mouseleave",t[13]),s=!0)},p(c,h){const _={};if(h&8&&(_.active=c[3]===A.CREATE),h&16&&(_.enabled=c[4]),h&32&&(_.title="Create "+c[5]+" Features"),h&262176&&(_.$$scope={dirty:h,ctx:c}),n.$set(_),h&736){a=c[6];let p;for(p=0;p<a.length;p+=1){const R=wt(c,a,p);d[p]?(d[p].p(R,h),w(d[p],1)):(d[p]=yt(R),d[p].c(),w(d[p],1),d[p].m(o,null))}for(ae(),p=a.length;p<d.length;p+=1)u(p);fe()}(!i||h&68&&r!==(r=c[2]&&c[6].length>1?"flex":"hidden"))&&g(o,"class",r)},i(c){if(!i){w(n.$$.fragment,c);for(let h=0;h<a.length;h+=1)w(d[h]);i=!0}},o(c){O(n.$$.fragment,c),d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)O(d[h]);i=!1},d(c){c&&S(e),q(n),ot(d,c),s=!1,f()}}}function An(t){let e,n;return e=new ze({props:{icon:t[7][t[5]],fw:!0,size:"sm",class:"mx-auto"}}),{c(){H(e.$$.fragment)},m(l,o){z(e,l,o),n=!0},p(l,o){const r={};o&32&&(r.icon=l[7][l[5]]),e.$set(r)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function jn(t){let e,n,l;return e=new ze({props:{icon:t[7][t[15]],fw:!0,size:"sm",class:"mx-auto"}}),{c(){H(e.$$.fragment),n=F()},m(o,r){z(e,o,r),T(o,n,r),l=!0},p(o,r){const i={};r&64&&(i.icon=o[7][o[15]]),e.$set(i)},i(o){l||(w(e.$$.fragment,o),l=!0)},o(o){O(e.$$.fragment,o),l=!1},d(o){q(e,o),o&&S(n)}}}function yt(t){let e,n;function l(...o){return t[12](t[15],...o)}return e=new qe({props:{active:t[5]===t[15],title:t[15],onClick:l,$$slots:{default:[jn]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(o,r){z(e,o,r),n=!0},p(o,r){t=o;const i={};r&96&&(i.active=t[5]===t[15]),r&64&&(i.title=t[15]),r&64&&(i.onClick=l),r&262208&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(o){n||(w(e.$$.fragment,o),n=!0)},o(o){O(e.$$.fragment,o),n=!1},d(o){q(e,o)}}}function Et(t){let e,n;return e=new qe({props:{active:t[3]===A.EDIT,enabled:t[4],title:"Edit Features",onClick:t[14],$$slots:{default:[Rn]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(l,o){z(e,l,o),n=!0},p(l,o){const r={};o&8&&(r.active=l[3]===A.EDIT),o&16&&(r.enabled=l[4]),o&262144&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Rn(t){let e,n;return e=new ze({props:{icon:In,fw:!0,size:"sm",class:"mx-auto"}}),{c(){H(e.$$.fragment)},m(l,o){z(e,l,o),n=!0},p:U,i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Fn(t){let e,n,l,o=t[0]&&Ct(t),r=t[1]&&Et(t);return{c(){o&&o.c(),e=F(),r&&r.c(),n=rt()},m(i,s){o&&o.m(i,s),T(i,e,s),r&&r.m(i,s),T(i,n,s),l=!0},p(i,[s]){i[0]?o?(o.p(i,s),s&1&&w(o,1)):(o=Ct(i),o.c(),w(o,1),o.m(e.parentNode,e)):o&&(ae(),O(o,1,1,()=>{o=null}),fe()),i[1]?r?(r.p(i,s),s&2&&w(r,1)):(r=Et(i),r.c(),w(r,1),r.m(n.parentNode,n)):r&&(ae(),O(r,1,1,()=>{r=null}),fe())},i(i){l||(w(o),w(r),l=!0)},o(i){O(o),O(r),l=!1},d(i){o&&o.d(i),i&&S(e),r&&r.d(i),i&&S(n)}}}function Gn(t,e,n){let l,o,r,i;J(t,ee,y=>n(3,l=y)),J(t,W,y=>n(4,o=y)),J(t,un,y=>n(5,r=y)),J(t,mt,y=>n(6,i=y));const s={[D.POINT]:Ln,[D.LINE_STRING]:Nn,[D.POLYGON]:Sn};let{create:f=!0}=e,{edit:a=!0}=e,d=!1;const u=(y,G)=>{y.blur(),ee.update(M=>{const b=M===G&&o?A.NONE:M===A.NONE||o?G:M;return console.log(M,G,"->",b),b})},c=(y,G)=>{y.blur(),Le.set(G),l!==A.CREATE&&u(y,A.CREATE)},h=y=>u(y.currentTarget,A.CREATE),_=()=>n(2,d=!0),p=(y,G)=>c(G.currentTarget,y),R=()=>n(2,d=!1),x=y=>u(y.currentTarget,A.EDIT);return t.$$set=y=>{"create"in y&&n(0,f=y.create),"edit"in y&&n(1,a=y.edit)},[f,a,d,l,o,r,i,s,u,c,h,_,p,R,x]}class Mn extends ue{constructor(e){super(),ce(this,e,Gn,Fn,ne,{create:0,edit:1})}}class Dn extends Ze.default{constructor({position:e={},...n}){const l=document.createElement("div");l.className="ogc-api-crud-tools ol-unselectable ol-control flex flex-col",Object.keys(e).forEach(o=>{l.style[o]=e[o]}),new Mn({target:l,props:n}),super({element:l})}}function Yn(t){let e,n,l,o,r,i;const s=t[5].default,f=xe(s,t,t[4],null);return{c(){e=I("button"),f&&f.c(),e.disabled=n=!t[0],g(e,"class",l=`px-4 py-1 text-sm text-white ${t[1]} disabled:${t[1]}/75 font-semibold rounded-full border border-transparent focus:outline-none hover:enabled:ring-2 ${t[2]} hover:enabled:ring-offset-2`)},m(a,d){T(a,e,d),f&&f.m(e,null),o=!0,r||(i=se(e,"click",function(){ye(t[3])&&t[3].apply(this,arguments)}),r=!0)},p(a,[d]){t=a,f&&f.p&&(!o||d&16)&&nt(f,s,t,t[4],o?tt(s,t[4],d,null):lt(t[4]),null),(!o||d&1&&n!==(n=!t[0]))&&(e.disabled=n),(!o||d&6&&l!==(l=`px-4 py-1 text-sm text-white ${t[1]} disabled:${t[1]}/75 font-semibold rounded-full border border-transparent focus:outline-none hover:enabled:ring-2 ${t[2]} hover:enabled:ring-offset-2`))&&g(e,"class",l)},i(a){o||(w(f,a),o=!0)},o(a){O(f,a),o=!1},d(a){a&&S(e),f&&f.d(a),r=!1,i()}}}function Vn(t,e,n){let{$$slots:l={},$$scope:o}=e,{enabled:r=!0}=e,{color:i="bg-slate-300"}=e,{ringColor:s="ring-slate-300"}=e,{onClick:f}=e;return t.$$set=a=>{"enabled"in a&&n(0,r=a.enabled),"color"in a&&n(1,i=a.color),"ringColor"in a&&n(2,s=a.ringColor),"onClick"in a&&n(3,f=a.onClick),"$$scope"in a&&n(4,o=a.$$scope)},[r,i,s,f,o,l]}class ge extends ue{constructor(e){super(),ce(this,e,Vn,Yn,ne,{enabled:0,color:1,ringColor:2,onClick:3})}}function vt(t,e,n){const l=t.slice();return l[3]=e[n],l}function Ot(t){let e,n,l,o;function r(...i){return t[2](t[3],...i)}return{c(){e=I("input"),g(e,"type","text"),g(e,"class","w-full bg-transparent p-1 placeholder:italic placeholder:text-slate-400"),e.value=n=t[3].value,g(e,"placeholder","not set")},m(i,s){T(i,e,s),l||(o=se(e,"input",r),l=!0)},p(i,s){t=i,s&1&&n!==(n=t[3].value)&&e.value!==n&&(e.value=n)},d(i){i&&S(e),l=!1,o()}}}function St(t){let e,n,l=t[3].label+"",o,r,i,s,f,a,d=t[3].isValue&&Ot(t);return{c(){e=I("tr"),n=I("td"),o=B(l),s=F(),f=I("td"),d&&d.c(),a=F(),g(n,"class",r=`w-1/3 p-1 pl-${t[3].depth*4}`),g(n,"title",i=t[3].name),g(e,"class","even:bg-slate-300/40"),X(e,"font-bold",t[3].isDirty)},m(u,c){T(u,e,c),E(e,n),E(n,o),E(e,s),E(e,f),d&&d.m(f,null),E(e,a)},p(u,c){c&1&&l!==(l=u[3].label+"")&&Ee(o,l),c&1&&r!==(r=`w-1/3 p-1 pl-${u[3].depth*4}`)&&g(n,"class",r),c&1&&i!==(i=u[3].name)&&g(n,"title",i),u[3].isValue?d?d.p(u,c):(d=Ot(u),d.c(),d.m(f,null)):d&&(d.d(1),d=null),c&1&&X(e,"font-bold",u[3].isDirty)},d(u){u&&S(e),d&&d.d()}}}function zn(t){let e,n=t[0],l=[];for(let o=0;o<n.length;o+=1)l[o]=St(vt(t,n,o));return{c(){e=I("table");for(let o=0;o<l.length;o+=1)l[o].c();g(e,"class","w-full border-collapse text-sm")},m(o,r){T(o,e,r);for(let i=0;i<l.length;i+=1)l[i].m(e,null)},p(o,[r]){if(r&3){n=o[0];let i;for(i=0;i<n.length;i+=1){const s=vt(o,n,i);l[i]?l[i].p(s,r):(l[i]=St(s),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},i:U,o:U,d(o){o&&S(e),ot(l,o)}}}function qn(t,e,n){let{editables:l=[]}=e;const o=(i,s)=>{re.update((f={})=>({...f,[i]:s}))},r=(i,s)=>o(i.name,s.target.value);return t.$$set=i=>{"editables"in i&&n(0,l=i.editables)},[l,o,r]}class Un extends ue{constructor(e){super(),ce(this,e,qn,zn,ne,{editables:0})}}function Hn(t){let e;return{c(){e=B("Save")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Jn(t){let e;return{c(){e=B("Cancel")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Tt(t){let e,n;return e=new ge({props:{color:"bg-red-600",ringColor:"ring-red-600",onClick:t[11],$$slots:{default:[Bn]},$$scope:{ctx:t}}}),{c(){H(e.$$.fragment)},m(l,o){z(e,l,o),n=!0},p(l,o){const r={};o&262144&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(w(e.$$.fragment,l),n=!0)},o(l){O(e.$$.fragment,l),n=!1},d(l){q(e,l)}}}function Bn(t){let e;return{c(){e=B("Delete")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Lt(t){let e;return{c(){e=I("div"),e.innerHTML='<div class="text-xl font-bold text-slate-500 animate-pulse">Saving...</div>',g(e,"id","ogc-api-editor-panel-overlay"),g(e,"class","bg-white/90 absolute w-full h-full flex justify-center items-center")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function It(t){let e,n,l,o,r,i;return r=new ge({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[14],$$slots:{default:[Xn]},$$scope:{ctx:t}}}),{c(){e=I("div"),n=I("div"),l=B(t[9]),o=F(),H(r.$$.fragment),g(n,"class","text-xl font-bold text-slate-500 text-center"),g(e,"id","ogc-api-editor-panel-error"),g(e,"class","bg-red-200/90 absolute w-full h-full flex flex-col gap-2 justify-center items-center")},m(s,f){T(s,e,f),E(e,n),E(n,l),E(e,o),z(r,e,null),i=!0},p(s,f){(!i||f&512)&&Ee(l,s[9]);const a={};f&262144&&(a.$$scope={dirty:f,ctx:s}),r.$set(a)},i(s){i||(w(r.$$.fragment,s),i=!0)},o(s){O(r.$$.fragment,s),i=!1},d(s){s&&S(e),q(r)}}}function Xn(t){let e;return{c(){e=B("Ok")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Nt(t){let e,n,l,o,r,i,s,f;return r=new ge({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[15],$$slots:{default:[Zn]},$$scope:{ctx:t}}}),s=new ge({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[16],$$slots:{default:[Kn]},$$scope:{ctx:t}}}),{c(){e=I("div"),n=I("div"),n.innerHTML=`The feature was changed by somebody else since you started to edit it.
        It will now be reloaded and you will be taken back to the editor.<br/>You can either discard your changes to see what was changed remotely
        or merge your changes on top of the reloaded feature which might hide
        the remote changes.`,l=F(),o=I("div"),H(r.$$.fragment),i=F(),H(s.$$.fragment),g(n,"class","text-base text-slate-500 text-center"),g(o,"class","flex flex-row gap-2"),g(e,"id","ogc-api-editor-panel-conflict"),g(e,"class","bg-amber-100/90 absolute w-full h-full flex flex-col gap-2 justify-around items-center p-2")},m(a,d){T(a,e,d),E(e,n),E(e,l),E(e,o),z(r,o,null),E(o,i),z(s,o,null),f=!0},p(a,d){const u={};d&2&&(u.onClick=a[15]),d&262144&&(u.$$scope={dirty:d,ctx:a}),r.$set(u);const c={};d&262144&&(c.$$scope={dirty:d,ctx:a}),s.$set(c)},i(a){f||(w(r.$$.fragment,a),w(s.$$.fragment,a),f=!0)},o(a){O(r.$$.fragment,a),O(s.$$.fragment,a),f=!1},d(a){a&&S(e),q(r),q(s)}}}function Zn(t){let e;return{c(){e=B("Discard my changes")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Kn(t){let e;return{c(){e=B("Merge my changes")},m(n,l){T(n,e,l)},d(n){n&&S(e)}}}function Qn(t){let e,n,l,o,r,i,s,f,a,d,u,c,h,_,p,R,x,y,G,M;d=new ge({props:{color:"bg-sky-600",ringColor:"ring-sky-600",enabled:t[5],onClick:t[10],$$slots:{default:[Hn]},$$scope:{ctx:t}}}),c=new ge({props:{onClick:bt,$$slots:{default:[Jn]},$$scope:{ctx:t}}});let b=t[6]===A.EDIT&&t[0]&&Tt(t);R=new Un({props:{editables:t[7]}});let L=t[8]===Y.SYNC&&Lt(),N=t[8]===Y.ERROR&&It(t),k=t[8]===Y.CONFLICT&&Nt(t);return{c(){e=I("div"),n=I("div"),l=I("div"),o=I("h3"),r=B(t[3]),i=F(),s=I("h3"),f=B(t[4]),a=F(),H(d.$$.fragment),u=F(),H(c.$$.fragment),h=F(),b&&b.c(),_=F(),p=I("div"),H(R.$$.fragment),x=F(),L&&L.c(),y=F(),N&&N.c(),G=F(),k&&k.c(),g(o,"id","ogc-api-editor-panel-header"),g(o,"class","text-lg font-bold text-slate-700"),g(s,"id","ogc-api-editor-panel-header2"),g(s,"class","text-base font-semibold text-slate-500"),g(l,"class","flex flex-col items-center border-b-2 border-slate-500 pb-2"),g(n,"id","ogc-api-editor-panel-main"),g(n,"class","flex flex-col justify-between py-2 px-4 min-w-[150px]"),g(p,"id","ogc-api-editor-panel-attributes"),g(p,"class","grow p-2 overflow-y-auto"),g(e,"id","ogc-api-editor-panel"),g(e,"class","ol-unselectable font-sans bg-white/90 text-slate-700 flex transform absolute bottom-0 left-0 w-full h-1/4 ease-in-out transition-transform duration-1000 pointer-events-auto"),X(e,"translate-y-full",t[2]),X(e,"translate-y-0",!t[2])},m(C,m){T(C,e,m),E(e,n),E(n,l),E(l,o),E(o,r),E(l,i),E(l,s),E(s,f),E(n,a),z(d,n,null),E(n,u),z(c,n,null),E(n,h),b&&b.m(n,null),E(e,_),E(e,p),z(R,p,null),E(e,x),L&&L.m(e,null),E(e,y),N&&N.m(e,null),E(e,G),k&&k.m(e,null),M=!0},p(C,[m]){(!M||m&8)&&Ee(r,C[3]),(!M||m&16)&&Ee(f,C[4]);const He={};m&32&&(He.enabled=C[5]),m&262144&&(He.$$scope={dirty:m,ctx:C}),d.$set(He);const kt={};m&262144&&(kt.$$scope={dirty:m,ctx:C}),c.$set(kt),C[6]===A.EDIT&&C[0]?b?(b.p(C,m),m&65&&w(b,1)):(b=Tt(C),b.c(),w(b,1),b.m(n,null)):b&&(ae(),O(b,1,1,()=>{b=null}),fe());const Pt={};m&128&&(Pt.editables=C[7]),R.$set(Pt),C[8]===Y.SYNC?L||(L=Lt(),L.c(),L.m(e,y)):L&&(L.d(1),L=null),C[8]===Y.ERROR?N?(N.p(C,m),m&256&&w(N,1)):(N=It(C),N.c(),w(N,1),N.m(e,G)):N&&(ae(),O(N,1,1,()=>{N=null}),fe()),C[8]===Y.CONFLICT?k?(k.p(C,m),m&256&&w(k,1)):(k=Nt(C),k.c(),w(k,1),k.m(e,null)):k&&(ae(),O(k,1,1,()=>{k=null}),fe()),m&4&&X(e,"translate-y-full",C[2]),m&4&&X(e,"translate-y-0",!C[2])},i(C){M||(w(d.$$.fragment,C),w(c.$$.fragment,C),w(b),w(R.$$.fragment,C),w(N),w(k),M=!0)},o(C){O(d.$$.fragment,C),O(c.$$.fragment,C),O(b),O(R.$$.fragment,C),O(N),O(k),M=!1},d(C){C&&S(e),q(d),q(c),b&&b.d(),q(R),L&&L.d(),N&&N.d(),k&&k.d()}}}function Wn(t,e,n){let l,o,r,i,s,f,a,d;J(t,W,b=>n(2,l=b)),J(t,$,b=>n(3,o=b)),J(t,ht,b=>n(4,r=b)),J(t,_t,b=>n(5,i=b)),J(t,ee,b=>n(6,s=b)),J(t,dn,b=>n(7,f=b)),J(t,Z,b=>n(8,a=b)),J(t,dt,b=>n(9,d=b));let{allowDelete:u}=e,{onSaveAsync:c}=e,{onDeleteAsync:h}=e;const _={},p=b=>b.then(L=>{L?(console.log("CONFLICT"),n(1,_.discard=L,_)):(console.log("CLEARING"),bt())}).catch(L=>{console.log("ERROR",L),dt.set(L.message),Z.set(Y.ERROR)}),R=()=>(Z.set(Y.SYNC),p(c())),x=()=>(Z.set(Y.SYNC),p(h())),y=()=>Z.set(Y.IDLE),G=()=>{_.discard(),Z.set(Y.IDLE)},M=()=>{Z.set(Y.IDLE)};return t.$$set=b=>{"allowDelete"in b&&n(0,u=b.allowDelete),"onSaveAsync"in b&&n(12,c=b.onSaveAsync),"onDeleteAsync"in b&&n(13,h=b.onDeleteAsync)},[u,_,l,o,r,i,s,f,a,d,R,x,c,h,y,G,M]}class $n extends ue{constructor(e){super(),ce(this,e,Wn,Qn,ne,{allowDelete:0,onSaveAsync:12,onDeleteAsync:13})}}class xn extends Ze.default{constructor({map:e,...n}){const l=e.getOverlayContainerStopEvent();new $n({target:l,props:n}),super({})}setMap(e){e.render()}}var nl="";const Ue=(t=1e3)=>new Promise(e=>setTimeout(e,t));class el{constructor({api:e={},tools:n={},dryRun:l=!1}={}){this.api={crs:"http://www.opengis.net/def/crs/OGC/1.3/CRS84",styleFunction:void 0,...e,schemas:{custom:null,create:"schema?type=create",replace:"schema?type=replace",update:"schema?type=update",...e.schemas||{}},capabilities:{crs:!1,patch:!1,maxAllowableOffset:!1,...e.capabilities||{}}},this.tools={create:!0,edit:!0,delete:!0,initial:"CREATE",position:{top:"5rem",left:"0.5rem"},styleFunction:void 0,styleOptions:{color:"red",strokeWidth:2,circleRadius:5,fillOpacity:""},...n},this.tools.styleFunction||(this.tools.styleFunction=bn(this.tools.styleOptions)),this.dryRun=l}addToMap(e){const{url:n,collections:l,crs:o,styleFunction:r}=this.api,i=l[0],s={[i]:{id:i,crs:o}};$.set(i);const f=Object.values(s).map(u=>Zt(n,u.id,this.api.schemas).then(c=>{console.log(c);const h=Ye(c.properties.properties,c.$defs);console.log(h);let _=ut(c.properties.geometry,c.$defs);_.includes(D.MULTI_POINT)&&_.splice(_.indexOf(D.MULTI_POINT),1,D.POINT),_.includes(D.MULTI_LINE_STRING)&&_.splice(_.indexOf(D.MULTI_LINE_STRING),1,D.LINE_STRING),_.includes(D.MULTI_POLYGON)&&_.splice(_.indexOf(D.MULTI_POLYGON),1,D.POLYGON),_=[...new Set(_)],console.log(_),_.length>0&&Le.update(p=>p||_[0]),ke.update(p=>({...p,[u.id]:{...u,label:c.title,properties:h.properties,geoTypes:_}}))}));Promise.all(f).then(u=>console.log("INITIALIZED",u));const a=this.items=rn(n,i,1e3,o,r),d=sn(o,this.tools.styleFunction,e.getView().getProjection());e.addControl(new Dn(this.tools)),e.addControl(new xn({map:e,allowDelete:this.tools.delete,onSaveAsync:()=>{const u=cn(e.getView().getProjection(),o);return this._syncChanges(u)},onDeleteAsync:this._deleteFeature.bind(this)})),e.addInteraction(hn(d.getSource())),this.tools.create&&e.getInteractions().extend(_n(d.getSource(),s[i])),this.tools.edit&&(e.addInteraction(gn(d.getSource())),e.addInteraction(mn(n,s,a.getSource(),this.api.schemas.custom==="schemas/replace"?"schema=receivables":""))),e.addLayer(a),e.addLayer(d),this.geoJson=fn(e.getView().getProjection(),o)}_syncChanges(e){if(console.log("_syncChanges"),P(_t)){const n=P(ke)[P($)];return P(ee)===A.CREATE?this.dryRun?(console.log("POST",n.id,e),Ue()):Jt(this.api.url,n.id,e,this.api.crs).then(l=>{console.log("id",l);const o=this.geoJson.readFeature({...e,id:l});this.items.getSource().addFeature(o)}):this.dryRun?(console.log("PUT",n.id,e.id,e),Ue()):Bt(this.api.url,n.id,e,this.api.crs,P(Ne)).then(()=>{const l=this.geoJson.readFeature(e);this.items.getSource().addFeature(l)}).catch(l=>{if(l.message.indexOf("412")===0){const o=()=>{oe.set(void 0),re.set(void 0)};return Ke(this.api.url,n.id,e.id,n.crs,this.api.schemas.custom==="schemas/replace"?"schema=receivables":"").then(r=>(K.set(r.feature),Ne.set(r.etag),Z.set(Y.CONFLICT),o))}else throw l})}return Promise.resolve()}_deleteFeature(){if(P(K))return pe.set(void 0),this.dryRun?(console.log("DELETE",P($),P(K).id),Ue()):Xt(this.api.url,P($),P(K).id).then(()=>{})}}return el});
