(function(A,de){typeof exports=="object"&&typeof module!="undefined"?module.exports=de(require("ol/interaction/Draw"),require("ol/interaction/Modify"),require("ol/interaction/Snap"),require("ol/interaction/Interaction"),require("ol/format/GeoJSON"),require("ol/source/Vector"),require("ol/layer/Vector"),require("ol/proj/Projection"),require("ol/loadingstrategy"),require("ol/tilegrid"),require("ol/style"),require("ol/geom"),require("ol/control/Control")):typeof define=="function"&&define.amd?define(["ol/interaction/Draw","ol/interaction/Modify","ol/interaction/Snap","ol/interaction/Interaction","ol/format/GeoJSON","ol/source/Vector","ol/layer/Vector","ol/proj/Projection","ol/loadingstrategy","ol/tilegrid","ol/style","ol/geom","ol/control/Control"],de):(A=typeof globalThis!="undefined"?globalThis:A||self,A.OgcApiEditor=de(A.ol.interaction.Draw,A.ol.interaction.Modify,A.ol.interaction.Snap,A.ol.interaction.Interaction,A.ol.format.GeoJSON,A.ol.source.Vector,A.ol.layer.Vector,A.ol.proj.Projection,A.ol.loadingstrategy,A.ol.tilegrid,A.ol.style,A.ol.geom,A.ol.control.Control))})(this,function(A,de,At,jt,Ft,Rt,Dt,Gt,Mt,Yt,E,Pe,Vt){"use strict";function Q(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var zt=Q(A),qt=Q(de),Ht=Q(At),Jt=Q(jt),Ce=Q(Ft),Be=Q(Rt),Xe=Q(Dt),Ze=Q(Gt),Ke=Q(Vt);const Qe=(t,e,n,l)=>fetch(`${t}/collections/${e}/items/${n}?schema=receivables${l?"&crs="+l:""}`,{headers:{Accept:"application/geo+json"}}).then(We(!0)),Ut=(t,e,n,l)=>fetch(`${t}/collections/${e}/items`,{headers:{"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`},method:"POST",body:JSON.stringify(n)}).then(Ae).then(Kt),Bt=(t,e,n,l,o)=>{const r={"Content-Type":"application/geo+json; charset=utf-8","Content-Crs":`<${l}>`,Accept:"application/json"};return o&&(r["If-Match"]=o),fetch(`${t}/collections/${e}/items/${n.id}`,{headers:r,method:"PUT",body:JSON.stringify(n)}).then(Ae)},Xt=(t,e,n)=>fetch(`${t}/collections/${e}/items/${n}`,{method:"DELETE"}).then(Ae),Zt=(t,e)=>fetch(`${t}/collections/${e}/schemas/replace`,{headers:{Accept:"application/schema+json"}}).then(We(!1)),We=t=>e=>(console.log("ETag",e.headers.get("etag")),e&&e.ok?e.json().then(n=>t?{feature:n,etag:e.headers.get("etag")}:n):t?{feature:{},etag:e.headers.get("etag")}:{}),Kt=t=>t&&t.ok?t.headers.get("location").substr(t.headers.get("location").lastIndexOf("/")+1):void 0,Ae=t=>{if(t.ok)return t;if(t.bodyUsed)return t.json().then(e=>{je(t,e.detail)}).catch(()=>{je(t)});je(t)},je=(t,e)=>{t.status;let n=t.status+" "+t.statusText;throw e&&(n+="<br/>"+e),new Error(n)},P={NONE:"NONE",CREATE:"CREATE",EDIT:"EDIT"},re={POINT:"Point",LINE_STRING:"LineString",POLYGON:"Polygon",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},G={IDLE:"IDLE",SYNC:"SYNC",SUCCESS:"SUCCESS",ERROR:"ERROR",CONFLICT:"CONFLICT"};class Qt extends Jt.default{constructor(e){super();const n=e||{};this._onSelect=n.onSelect||null,this._collections=n._collections||[]}handleEvent(e){let n=!1;if(e.type==="click"){const l=e.map,o=[];l.forEachFeatureAtPixel(e.pixel,(r,i)=>{o.push({feature:r,layer:i.get("collection")})},{layerFilter:r=>this._collections.length===0||this._collections.includes(r.get("collection"))}),o.length>0&&(this.setActive(!1),this._onSelect(o)),n=!0}return!n}}function H(){}function Wt(t,e){for(const n in e)t[n]=e[n];return t}function $e(t){return t()}function xe(){return Object.create(null)}function ee(t){t.forEach($e)}function we(t){return typeof t=="function"}function te(t,e){return t!=t?e==e:t!==e||t&&typeof t=="object"||typeof t=="function"}function $t(t){return Object.keys(t).length===0}function Fe(t,...e){if(t==null)return H;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function N(t){let e;return Fe(t,n=>e=n)(),e}function U(t,e,n){t.$$.on_destroy.push(Fe(e,n))}function et(t,e,n,l){if(t){const o=tt(t,e,n,l);return t[0](o)}}function tt(t,e,n,l){return t[1]&&l?Wt(n.ctx.slice(),t[1](l(e))):n.ctx}function nt(t,e,n,l){if(t[2]&&l){const o=t[2](l(n));if(e.dirty===void 0)return o;if(typeof o=="object"){const r=[],i=Math.max(e.dirty.length,o.length);for(let s=0;s<i;s+=1)r[s]=e.dirty[s]|o[s];return r}return e.dirty|o}return e.dirty}function lt(t,e,n,l,o,r){if(o){const i=tt(e,n,l,r);t.p(i,o)}}function ot(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let l=0;l<n;l++)e[l]=-1;return e}return-1}function w(t,e){t.appendChild(e)}function T(t,e,n){t.insertBefore(e,n||null)}function O(t){t.parentNode.removeChild(t)}function rt(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function L(t){return document.createElement(t)}function ie(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function B(t){return document.createTextNode(t)}function F(){return B(" ")}function it(){return B("")}function se(t,e,n,l){return t.addEventListener(e,n,l),()=>t.removeEventListener(e,n,l)}function g(t,e,n){n==null?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function xt(t){return Array.from(t.childNodes)}function ye(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function X(t,e,n){t.classList[n?"add":"remove"](e)}let Re;function ge(t){Re=t}function st(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach(l=>l.call(this,e))}const he=[],at=[],ve=[],ft=[],en=Promise.resolve();let De=!1;function tn(){De||(De=!0,en.then(ct))}function Ge(t){ve.push(t)}const Me=new Set;let Ee=0;function ct(){const t=Re;do{for(;Ee<he.length;){const e=he[Ee];Ee++,ge(e),nn(e.$$)}for(ge(null),he.length=0,Ee=0;at.length;)at.pop()();for(let e=0;e<ve.length;e+=1){const n=ve[e];Me.has(n)||(Me.add(n),n())}ve.length=0}while(he.length);for(;ft.length;)ft.pop()();De=!1,Me.clear(),ge(t)}function nn(t){if(t.fragment!==null){t.update(),ee(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Ge)}}const Oe=new Set;let ne;function me(){ne={r:0,c:[],p:ne}}function _e(){ne.r||ee(ne.c),ne=ne.p}function y(t,e){t&&t.i&&(Oe.delete(t),t.i(e))}function S(t,e,n,l){if(t&&t.o){if(Oe.has(t))return;Oe.add(t),ne.c.push(()=>{Oe.delete(t),l&&(n&&t.d(1),l())}),t.o(e)}else l&&l()}function J(t){t&&t.c()}function V(t,e,n,l){const{fragment:o,on_mount:r,on_destroy:i,after_update:s}=t.$$;o&&o.m(e,n),l||Ge(()=>{const f=r.map($e).filter(we);i?i.push(...f):ee(f),t.$$.on_mount=[]}),s.forEach(Ge)}function z(t,e){const n=t.$$;n.fragment!==null&&(ee(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ln(t,e){t.$$.dirty[0]===-1&&(he.push(t),tn(),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function ae(t,e,n,l,o,r,i,s=[-1]){const f=Re;ge(t);const a=t.$$={fragment:null,ctx:null,props:r,update:H,not_equal:o,bound:xe(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(f?f.$$.context:[])),callbacks:xe(),dirty:s,skip_bound:!1,root:e.target||f.$$.root};i&&i(a.root);let d=!1;if(a.ctx=n?n(t,e.props||{},(c,u,...h)=>{const _=h.length?h[0]:u;return a.ctx&&o(a.ctx[c],a.ctx[c]=_)&&(!a.skip_bound&&a.bound[c]&&a.bound[c](_),d&&ln(t,c)),u}):[],a.update(),d=!0,ee(a.before_update),a.fragment=l?l(a.ctx):!1,e.target){if(e.hydrate){const c=xt(e.target);a.fragment&&a.fragment.l(c),c.forEach(O)}else a.fragment&&a.fragment.c();e.intro&&y(t.$$.fragment),V(t,e.target,e.anchor,e.customElement),ct()}ge(f)}class fe{$destroy(){z(this,1),this.$destroy=H}$on(e,n){const l=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return l.push(n),()=>{const o=l.indexOf(n);o!==-1&&l.splice(o,1)}}$set(e){this.$$set&&!$t(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const ce=[];function on(t,e){return{subscribe:M(t,e).subscribe}}function M(t,e=H){let n;const l=new Set;function o(s){if(te(t,s)&&(t=s,n)){const f=!ce.length;for(const a of l)a[1](),ce.push(a,t);if(f){for(let a=0;a<ce.length;a+=2)ce[a][0](ce[a+1]);ce.length=0}}}function r(s){o(s(t))}function i(s,f=H){const a=[s,f];return l.add(a),l.size===1&&(n=e(o)||H),s(t),()=>{l.delete(a),l.size===0&&(n(),n=null)}}return{set:o,update:r,subscribe:i}}function be(t,e,n){const l=!Array.isArray(t),o=l?[t]:t,r=e.length<2;return on(n,i=>{let s=!1;const f=[];let a=0,d=H;const c=()=>{if(a)return;d();const h=e(l?f[0]:f,i);r?i(h):d=we(h)?h:H},u=o.map((h,_)=>Fe(h,b=>{f[_]=b,a&=~(1<<_),s&&c()},()=>{a|=1<<_}));return s=!0,c(),function(){ee(u),d()}})}const rn=(t,e,n,l,o)=>{const r=new Be.default({format:new Ce.default({dataProjection:Se(l)}),loader:function(s,f,a,d,c){const u=`${t}/collections/${e}/items?f=json&limit=${n}&bbox=`+s[0]+","+s[1]+","+s[2]+","+s[3]+"&bbox-crs="+encodeURIComponent(an(a))+"&crs="+encodeURIComponent(l);fetch(u).then(h=>h.ok?h.json().then(_=>{var b=r.getFormat().readFeatures(_,{featureProjection:a});r.addFeatures(b),d(b)}):h.text().then(_=>c(`${h.status} ${h.statusText} - ${_}`)))},strategy:Mt.tile(Yt.createXYZ({tileSize:512}))});return new Xe.default({source:r,properties:{collection:e},style:o})},sn=(t,e,n)=>{const l=new Ce.default({dataProjection:Se(t)}),o=new Be.default({});return K.subscribe(r=>{if(r){const i=l.readFeature(r,{featureProjection:n});o.addFeature(i)}else o.clear()}),W.subscribe(r=>{r&&o.clear()}),new Xe.default({source:o,style:e})},an=t=>t.getCode().replace("EPSG:","http://www.opengis.net/def/crs/EPSG/0/"),Se=t=>t==="http://www.opengis.net/def/crs/OGC/1.3/CRS84"?new Ze.default({code:"EPSG:4326",axisOrientation:"neu"}):new Ze.default({code:t.replace("http://www.opengis.net/def/crs/EPSG/0/","EPSG:")}),ut=(t,e,n={},l=1,o="")=>Object.keys(t).flatMap(r=>t[r].type==="object"?[{name:o+r,label:t[r].title||r,isValue:!1,depth:l}].concat(ut(t[r].properties,e[r]||{},n,l+1,o+r+".")):{name:o+r,label:t[r].title||r,value:n[o+r]||e[r]||"",isDirty:n[o+r]&&n[o+r]!==e[r],isValue:!0,depth:l}),Ye=(t,e)=>{const n={...t};if(n.properties){const l=n.properties;Object.keys(l).forEach(o=>{l[o].$ref&&l[o].$ref.includes("$defs")&&(l[o]=e[l[o].$ref.substr(8)]),l[o].type==="object"&&(l[o]=Ye(l[o],e)),l[o].type==="array"&&delete l[o]})}return n},dt=(t,e)=>{const n=Ye(t,e),l=[];return n.properties&&n.properties.type&&n.properties.type.enum&&l.push(...n.properties.type.enum),n.oneOf&&n.oneOf.forEach(o=>{o.type==="object"&&l.push(...dt(o,e))}),l},fn=(t,e)=>new Ce.default({featureProjection:t,dataProjection:Se(e)}),cn=(t,e)=>{const n=N(x)===P.CREATE?{type:"Feature",properties:{}}:N(K);if(N(le)){const l=new Ce.default({featureProjection:t,dataProjection:Se(e)});n.geometry=l.writeGeometryObject(N(le),{rightHanded:!0,decimals:10})}if(N(oe)){const l=N(oe),o={...n.properties};Object.keys(l).forEach(r=>{const i=r.split(".");let s=o;for(let f=0;f<i.length-1;f++)s[i[f]]||(s[i[f]]={}),s=s[i[f]];s[i[i.length-1]]=l[r]}),n.properties=o}return n},x=M(P.NONE),Z=M(G.IDLE),Te=M(),W=M(!0),gt=M(),ht=be([x,Z,Te,W],([t,e,n,l])=>({tool:t,sync:e,geo:n,panelOff:l})),pe=M(),Le=M(),K=M(),ke=M(),Ie=M(),$=M(""),mt=M(""),le=M(),oe=M(),_t=be([Ie,$],([t,e])=>t&&t[e]?t[e].geoTypes:[]),un=be([Te,_t],([t,e])=>t&&e.includes(t)?t:e.length>0?e[0]:!1),bt=be([x,K,le,oe],([t,e,n,l])=>{const o=t===P.CREATE||e&&n;if(!o&&e&&l){const r=e.properties,i=l;return Object.keys(i).some(s=>i[s]!==r[s])}return o}),dn=be([Ie,$,K,oe,x,W],([t,e,n,l,o,r])=>!r&&t&&t[e]&&(n||o===P.CREATE)?ut(t[e].properties,n&&n.properties||{},l):[]),pt=()=>{N(Le)&&N(pe)&&N(pe)(N(Le)),ke.set(void 0),Le.set(void 0),K.set(void 0),pe.set(void 0),le.set(void 0),oe.set(void 0),Z.set(G.IDLE),W.set(!0)},gn=t=>{const e=new qt.default({source:t});return e.on("modifyend",n=>{n.features&&n.features.getLength()>0&&(console.log("mod",n.features.item(0).getGeometry().getRevision()),le.set(n.features.item(0).getGeometry()))}),W.subscribe(n=>{console.log("MODIFY",!n),e.setActive(!n)}),e},hn=t=>new Ht.default({source:t}),mn=(t,e,n)=>{const l=new Qt({collections:Object.keys(e),onSelect:o=>{const r=o[0],i=e[r.layer],s=r.feature.getId();Le.set(r.feature),pe.set(f=>n.addFeature(f)),n.removeFeature(r.feature),Qe(t,i.id,s,i.crs).then(f=>{$.set(i.id),mt.set(f.feature.id),K.set(f.feature),ke.set(f.etag),W.set(!1)})}});return l.setActive(!1),ht.subscribe(o=>{l.setActive(o.panelOff&&o.tool===P.EDIT)}),l},_n=(t,e)=>{const n={};return[re.POINT,re.LINE_STRING,re.POLYGON].forEach(l=>{const o=new zt.default({source:t,type:l});o.setActive(!1),o.on("drawend",r=>{console.log(r.feature.getGeometry().getRevision()),$.set(e.id),W.set(!1),le.set(r.feature.getGeometry())}),n[l]=o}),ht.subscribe(l=>{Object.keys(n).forEach(o=>{n[o].setActive(l.geo===o&&l.tool===P.CREATE&&l.panelOff)})}),Object.values(n)},bn=({color:t,strokeWidth:e,circleRadius:n,fillOpacity:l})=>{const o={Point:new E.Style({image:new E.Circle({radius:n,fill:new E.Fill({color:t})})}),LineString:[new E.Style({stroke:new E.Stroke({color:t,width:e})}),new E.Style({image:new E.Circle({radius:n,fill:new E.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates().reduce((s,f)=>s.concat(f),[]);return new Pe.MultiPoint(i)}})],MultiLineString:new E.Style({stroke:new E.Stroke({color:t,width:e})}),MultiPoint:new E.Style({image:new E.Circle({radius:n,fill:new E.Fill({color:t})})}),MultiPolygon:[new E.Style({stroke:new E.Stroke({color:t,width:e}),fill:new E.Fill({color:"rgba(255, 0, 0, 0.5)"})}),new E.Style({image:new E.Circle({radius:n,fill:new E.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates().reduce((s,f)=>s.concat(f[0]),[]);return new Pe.MultiPoint(i)}})],Polygon:[new E.Style({stroke:new E.Stroke({color:t,width:e}),fill:new E.Fill({color:"rgba(255, 0, 0, 0.5)"})}),new E.Style({image:new E.Circle({radius:n,fill:new E.Fill({color:t})}),geometry:function(r){const i=r.getGeometry().getCoordinates().reduce((s,f)=>s.concat(f[0]),[]);return new Pe.MultiPoint(i)}})]};return r=>o[r.getGeometry().getType()]},Ne=parseFloat;function Ve(t,e=";"){let n;if(Array.isArray(t))n=t.filter(l=>l);else{n=[];for(const l in t)t[l]&&n.push(`${l}:${t[l]}`)}return n.join(e)}function pn(t,e,n,l){let o,r;const i="1em";let s,f,a,d="-.125em";const c="visible";return l&&(a="center",r="1.25em"),n&&(o=n),e&&(e=="lg"?(f="1.33333em",s=".75em",d="-.225em"):e=="xs"?f=".75em":e=="sm"?f=".875em":f=e.replace("x","em")),Ve([Ve({float:o,width:r,height:i,"line-height":s,"font-size":f,"text-align":a,"vertical-align":d,"transform-origin":"center",overflow:c}),t])}function Cn(t,e,n,l,o,r=1,i="",s=""){let f=1,a=1;return o&&(o=="horizontal"?f=-1:o=="vertical"?a=-1:f=a=-1),Ve([`translate(${Ne(e)*r}${i},${Ne(n)*r}${i})`,`scale(${f*Ne(t)},${a*Ne(t)})`,l&&`rotate(${l}${s})`]," ")}var tl="";function Ct(t){let e,n,l,o,r,i,s,f;function a(u,h){return typeof u[10][4]=="string"?yn:wn}let d=a(t),c=d(t);return{c(){e=ie("svg"),n=ie("g"),l=ie("g"),c.c(),g(l,"transform",t[12]),g(n,"transform",o="translate("+t[10][0]/2+" "+t[10][1]/2+")"),g(n,"transform-origin",r=t[10][0]/4+" 0"),g(e,"id",i=t[1]||void 0),g(e,"class",s="svelte-fa "+t[0]+" svelte-1w3t65e"),g(e,"style",t[11]),g(e,"viewBox",f="0 0 "+t[10][0]+" "+t[10][1]),g(e,"aria-hidden","true"),g(e,"role","img"),g(e,"xmlns","http://www.w3.org/2000/svg"),X(e,"pulse",t[4]),X(e,"spin",t[3])},m(u,h){T(u,e,h),w(e,n),w(n,l),c.m(l,null)},p(u,h){d===(d=a(u))&&c?c.p(u,h):(c.d(1),c=d(u),c&&(c.c(),c.m(l,null))),h&4096&&g(l,"transform",u[12]),h&1024&&o!==(o="translate("+u[10][0]/2+" "+u[10][1]/2+")")&&g(n,"transform",o),h&1024&&r!==(r=u[10][0]/4+" 0")&&g(n,"transform-origin",r),h&2&&i!==(i=u[1]||void 0)&&g(e,"id",i),h&1&&s!==(s="svelte-fa "+u[0]+" svelte-1w3t65e")&&g(e,"class",s),h&2048&&g(e,"style",u[11]),h&1024&&f!==(f="0 0 "+u[10][0]+" "+u[10][1])&&g(e,"viewBox",f),h&17&&X(e,"pulse",u[4]),h&9&&X(e,"spin",u[3])},d(u){u&&O(e),c.d()}}}function wn(t){let e,n,l,o,r,i,s,f,a,d;return{c(){e=ie("path"),i=ie("path"),g(e,"d",n=t[10][4][0]),g(e,"fill",l=t[6]||t[2]||"currentColor"),g(e,"fill-opacity",o=t[9]!=!1?t[7]:t[8]),g(e,"transform",r="translate("+t[10][0]/-2+" "+t[10][1]/-2+")"),g(i,"d",s=t[10][4][1]),g(i,"fill",f=t[5]||t[2]||"currentColor"),g(i,"fill-opacity",a=t[9]!=!1?t[8]:t[7]),g(i,"transform",d="translate("+t[10][0]/-2+" "+t[10][1]/-2+")")},m(c,u){T(c,e,u),T(c,i,u)},p(c,u){u&1024&&n!==(n=c[10][4][0])&&g(e,"d",n),u&68&&l!==(l=c[6]||c[2]||"currentColor")&&g(e,"fill",l),u&896&&o!==(o=c[9]!=!1?c[7]:c[8])&&g(e,"fill-opacity",o),u&1024&&r!==(r="translate("+c[10][0]/-2+" "+c[10][1]/-2+")")&&g(e,"transform",r),u&1024&&s!==(s=c[10][4][1])&&g(i,"d",s),u&36&&f!==(f=c[5]||c[2]||"currentColor")&&g(i,"fill",f),u&896&&a!==(a=c[9]!=!1?c[8]:c[7])&&g(i,"fill-opacity",a),u&1024&&d!==(d="translate("+c[10][0]/-2+" "+c[10][1]/-2+")")&&g(i,"transform",d)},d(c){c&&O(e),c&&O(i)}}}function yn(t){let e,n,l,o;return{c(){e=ie("path"),g(e,"d",n=t[10][4]),g(e,"fill",l=t[2]||t[5]||"currentColor"),g(e,"transform",o="translate("+t[10][0]/-2+" "+t[10][1]/-2+")")},m(r,i){T(r,e,i)},p(r,i){i&1024&&n!==(n=r[10][4])&&g(e,"d",n),i&36&&l!==(l=r[2]||r[5]||"currentColor")&&g(e,"fill",l),i&1024&&o!==(o="translate("+r[10][0]/-2+" "+r[10][1]/-2+")")&&g(e,"transform",o)},d(r){r&&O(e)}}}function vn(t){let e,n=t[10][4]&&Ct(t);return{c(){n&&n.c(),e=it()},m(l,o){n&&n.m(l,o),T(l,e,o)},p(l,[o]){l[10][4]?n?n.p(l,o):(n=Ct(l),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},i:H,o:H,d(l){n&&n.d(l),l&&O(e)}}}function En(t,e,n){let{class:l=""}=e,{id:o=""}=e,{style:r=""}=e,{icon:i}=e,{size:s=""}=e,{color:f=""}=e,{fw:a=!1}=e,{pull:d=""}=e,{scale:c=1}=e,{translateX:u=0}=e,{translateY:h=0}=e,{rotate:_=""}=e,{flip:b=!1}=e,{spin:Y=!1}=e,{pulse:q=!1}=e,{primaryColor:v=""}=e,{secondaryColor:R=""}=e,{primaryOpacity:p=1}=e,{secondaryOpacity:j=.4}=e,{swapOpacity:D=!1}=e,k,I,C;return t.$$set=m=>{"class"in m&&n(0,l=m.class),"id"in m&&n(1,o=m.id),"style"in m&&n(13,r=m.style),"icon"in m&&n(14,i=m.icon),"size"in m&&n(15,s=m.size),"color"in m&&n(2,f=m.color),"fw"in m&&n(16,a=m.fw),"pull"in m&&n(17,d=m.pull),"scale"in m&&n(18,c=m.scale),"translateX"in m&&n(19,u=m.translateX),"translateY"in m&&n(20,h=m.translateY),"rotate"in m&&n(21,_=m.rotate),"flip"in m&&n(22,b=m.flip),"spin"in m&&n(3,Y=m.spin),"pulse"in m&&n(4,q=m.pulse),"primaryColor"in m&&n(5,v=m.primaryColor),"secondaryColor"in m&&n(6,R=m.secondaryColor),"primaryOpacity"in m&&n(7,p=m.primaryOpacity),"secondaryOpacity"in m&&n(8,j=m.secondaryOpacity),"swapOpacity"in m&&n(9,D=m.swapOpacity)},t.$$.update=()=>{t.$$.dirty&16384&&n(10,k=i&&i.icon||[0,0,"",[],""]),t.$$.dirty&237568&&n(11,I=pn(r,s,d,a)),t.$$.dirty&8126464&&n(12,C=Cn(c,u,h,_,b,512))},[l,o,f,Y,q,v,R,p,j,D,k,I,C,r,i,s,a,d,c,u,h,_,b]}class On extends fe{constructor(e){super(),ae(this,e,En,vn,te,{class:0,id:1,style:13,icon:14,size:15,color:2,fw:16,pull:17,scale:18,translateX:19,translateY:20,rotate:21,flip:22,spin:3,pulse:4,primaryColor:5,secondaryColor:6,primaryOpacity:7,secondaryOpacity:8,swapOpacity:9})}}var ze=On;/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var Sn={prefix:"fas",iconName:"draw-polygon",icon:[448,512,[],"f5ee","M384.3 352C419.5 352.2 448 380.7 448 416C448 451.3 419.3 480 384 480C360.3 480 339.6 467.1 328.6 448H119.4C108.4 467.1 87.69 480 64 480C28.65 480 0 451.3 0 416C0 392.3 12.87 371.6 32 360.6V151.4C12.87 140.4 0 119.7 0 96C0 60.65 28.65 32 64 32C87.69 32 108.4 44.87 119.4 64H328.6C339.6 44.87 360.3 32 384 32C419.3 32 448 60.65 448 96C448 131.3 419.5 159.8 384.3 159.1L345.5 227.9C349.7 236.4 352 245.9 352 256C352 266.1 349.7 275.6 345.5 284.1L384.3 352zM96 360.6C105.7 366.2 113.8 374.3 119.4 384H328.6C328.6 383.9 328.7 383.8 328.7 383.7L292.2 319.9C290.8 319.1 289.4 320 288 320C252.7 320 224 291.3 224 256C224 220.7 252.7 192 288 192C289.4 192 290.8 192 292.2 192.1L328.7 128.3L328.6 128H119.4C113.8 137.7 105.7 145.8 96 151.4L96 360.6z"]},Tn={prefix:"fas",iconName:"location-pin",icon:[384,512,["map-marker"],"f041","M384 192C384 279.4 267 435 215.7 499.2C203.4 514.5 180.6 514.5 168.3 499.2C116.1 435 0 279.4 0 192C0 85.96 85.96 0 192 0C298 0 384 85.96 384 192H384z"]},Ln=Tn,kn={prefix:"fas",iconName:"pencil",icon:[512,512,[61504,9999,"pencil-alt"],"f303","M421.7 220.3L188.5 453.4L154.6 419.5L158.1 416H112C103.2 416 96 408.8 96 400V353.9L92.51 357.4C87.78 362.2 84.31 368 82.42 374.4L59.44 452.6L137.6 429.6C143.1 427.7 149.8 424.2 154.6 419.5L188.5 453.4C178.1 463.8 165.2 471.5 151.1 475.6L30.77 511C22.35 513.5 13.24 511.2 7.03 504.1C.8198 498.8-1.502 489.7 .976 481.2L36.37 360.9C40.53 346.8 48.16 333.9 58.57 323.5L291.7 90.34L421.7 220.3zM492.7 58.75C517.7 83.74 517.7 124.3 492.7 149.3L444.3 197.7L314.3 67.72L362.7 19.32C387.7-5.678 428.3-5.678 453.3 19.32L492.7 58.75z"]},In={prefix:"fas",iconName:"slash",icon:[640,512,[],"f715","M5.112 9.196C13.29-1.236 28.37-3.065 38.81 5.112L630.8 469.1C641.2 477.3 643.1 492.4 634.9 502.8C626.7 513.2 611.6 515.1 601.2 506.9L9.196 42.89C-1.236 34.71-3.065 19.63 5.112 9.196V9.196z"]};function Nn(t){let e,n,l,o,r;const i=t[5].default,s=et(i,t,t[4],null);return{c(){e=L("button"),s&&s.c(),e.disabled=n=!t[0],g(e,"title",t[2]),g(e,"class","disabled:opacity-70 hover:disabled:opacity-50"),X(e,"!bg-ol-button-hover",t[1])},m(f,a){T(f,e,a),s&&s.m(e,null),l=!0,o||(r=[se(e,"click",function(){we(t[3])&&t[3].apply(this,arguments)}),se(e,"mouseenter",t[6]),se(e,"mouseleave",t[7])],o=!0)},p(f,[a]){t=f,s&&s.p&&(!l||a&16)&&lt(s,i,t,t[4],l?nt(i,t[4],a,null):ot(t[4]),null),(!l||a&1&&n!==(n=!t[0]))&&(e.disabled=n),(!l||a&4)&&g(e,"title",t[2]),a&2&&X(e,"!bg-ol-button-hover",t[1])},i(f){l||(y(s,f),l=!0)},o(f){S(s,f),l=!1},d(f){f&&O(e),s&&s.d(f),o=!1,ee(r)}}}function Pn(t,e,n){let{$$slots:l={},$$scope:o}=e,{enabled:r=!0}=e,{active:i=!1}=e,{title:s}=e,{onClick:f}=e;function a(c){st.call(this,t,c)}function d(c){st.call(this,t,c)}return t.$$set=c=>{"enabled"in c&&n(0,r=c.enabled),"active"in c&&n(1,i=c.active),"title"in c&&n(2,s=c.title),"onClick"in c&&n(3,f=c.onClick),"$$scope"in c&&n(4,o=c.$$scope)},[r,i,s,f,o,l,a,d]}class qe extends fe{constructor(e){super(),ae(this,e,Pn,Nn,te,{enabled:0,active:1,title:2,onClick:3})}}function wt(t,e,n){const l=t.slice();return l[15]=e[n],l}function yt(t){let e,n,l,o,r,i,s,f;n=new qe({props:{active:t[3]===P.CREATE,enabled:t[4],title:"Create "+t[5]+" Features",onClick:t[10],$$slots:{default:[An]},$$scope:{ctx:t}}}),n.$on("mouseenter",t[11]);let a=t[6],d=[];for(let u=0;u<a.length;u+=1)d[u]=vt(wt(t,a,u));const c=u=>S(d[u],1,1,()=>{d[u]=null});return{c(){e=L("div"),J(n.$$.fragment),l=F(),o=L("div");for(let u=0;u<d.length;u+=1)d[u].c();g(o,"class",r=t[2]&&t[6].length>1?"flex":"hidden"),g(e,"class","flex")},m(u,h){T(u,e,h),V(n,e,null),w(e,l),w(e,o);for(let _=0;_<d.length;_+=1)d[_].m(o,null);i=!0,s||(f=se(e,"mouseleave",t[13]),s=!0)},p(u,h){const _={};if(h&8&&(_.active=u[3]===P.CREATE),h&16&&(_.enabled=u[4]),h&32&&(_.title="Create "+u[5]+" Features"),h&262176&&(_.$$scope={dirty:h,ctx:u}),n.$set(_),h&736){a=u[6];let b;for(b=0;b<a.length;b+=1){const Y=wt(u,a,b);d[b]?(d[b].p(Y,h),y(d[b],1)):(d[b]=vt(Y),d[b].c(),y(d[b],1),d[b].m(o,null))}for(me(),b=a.length;b<d.length;b+=1)c(b);_e()}(!i||h&68&&r!==(r=u[2]&&u[6].length>1?"flex":"hidden"))&&g(o,"class",r)},i(u){if(!i){y(n.$$.fragment,u);for(let h=0;h<a.length;h+=1)y(d[h]);i=!0}},o(u){S(n.$$.fragment,u),d=d.filter(Boolean);for(let h=0;h<d.length;h+=1)S(d[h]);i=!1},d(u){u&&O(e),z(n),rt(d,u),s=!1,f()}}}function An(t){let e,n;return e=new ze({props:{icon:t[7][t[5]],fw:!0,size:"sm",class:"mx-auto"}}),{c(){J(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p(l,o){const r={};o&32&&(r.icon=l[7][l[5]]),e.$set(r)},i(l){n||(y(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){z(e,l)}}}function jn(t){let e,n,l;return e=new ze({props:{icon:t[7][t[15]],fw:!0,size:"sm",class:"mx-auto"}}),{c(){J(e.$$.fragment),n=F()},m(o,r){V(e,o,r),T(o,n,r),l=!0},p(o,r){const i={};r&64&&(i.icon=o[7][o[15]]),e.$set(i)},i(o){l||(y(e.$$.fragment,o),l=!0)},o(o){S(e.$$.fragment,o),l=!1},d(o){z(e,o),o&&O(n)}}}function vt(t){let e,n;function l(...o){return t[12](t[15],...o)}return e=new qe({props:{active:t[5]===t[15],title:t[15],onClick:l,$$slots:{default:[jn]},$$scope:{ctx:t}}}),{c(){J(e.$$.fragment)},m(o,r){V(e,o,r),n=!0},p(o,r){t=o;const i={};r&96&&(i.active=t[5]===t[15]),r&64&&(i.title=t[15]),r&64&&(i.onClick=l),r&262208&&(i.$$scope={dirty:r,ctx:t}),e.$set(i)},i(o){n||(y(e.$$.fragment,o),n=!0)},o(o){S(e.$$.fragment,o),n=!1},d(o){z(e,o)}}}function Et(t){let e,n;return e=new qe({props:{active:t[3]===P.EDIT,enabled:t[4],title:"Edit Features",onClick:t[14],$$slots:{default:[Fn]},$$scope:{ctx:t}}}),{c(){J(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p(l,o){const r={};o&8&&(r.active=l[3]===P.EDIT),o&16&&(r.enabled=l[4]),o&262144&&(r.$$scope={dirty:o,ctx:l}),e.$set(r)},i(l){n||(y(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){z(e,l)}}}function Fn(t){let e,n;return e=new ze({props:{icon:kn,fw:!0,size:"sm",class:"mx-auto"}}),{c(){J(e.$$.fragment)},m(l,o){V(e,l,o),n=!0},p:H,i(l){n||(y(e.$$.fragment,l),n=!0)},o(l){S(e.$$.fragment,l),n=!1},d(l){z(e,l)}}}function Rn(t){let e,n,l,o=t[0]&&yt(t),r=t[1]&&Et(t);return{c(){o&&o.c(),e=F(),r&&r.c(),n=it()},m(i,s){o&&o.m(i,s),T(i,e,s),r&&r.m(i,s),T(i,n,s),l=!0},p(i,[s]){i[0]?o?(o.p(i,s),s&1&&y(o,1)):(o=yt(i),o.c(),y(o,1),o.m(e.parentNode,e)):o&&(me(),S(o,1,1,()=>{o=null}),_e()),i[1]?r?(r.p(i,s),s&2&&y(r,1)):(r=Et(i),r.c(),y(r,1),r.m(n.parentNode,n)):r&&(me(),S(r,1,1,()=>{r=null}),_e())},i(i){l||(y(o),y(r),l=!0)},o(i){S(o),S(r),l=!1},d(i){o&&o.d(i),i&&O(e),r&&r.d(i),i&&O(n)}}}function Dn(t,e,n){let l,o,r,i;U(t,x,v=>n(3,l=v)),U(t,W,v=>n(4,o=v)),U(t,un,v=>n(5,r=v)),U(t,_t,v=>n(6,i=v));const s={[re.POINT]:Ln,[re.LINE_STRING]:In,[re.POLYGON]:Sn};let{create:f=!0}=e,{edit:a=!0}=e,d=!1;const c=(v,R)=>{v.blur(),x.update(p=>{const j=p===R&&o?P.NONE:p===P.NONE||o?R:p;return console.log(p,R,"->",j),j})},u=(v,R)=>{v.blur(),Te.set(R),l!==P.CREATE&&c(v,P.CREATE)},h=v=>c(v.currentTarget,P.CREATE),_=()=>n(2,d=!0),b=(v,R)=>u(R.currentTarget,v),Y=()=>n(2,d=!1),q=v=>c(v.currentTarget,P.EDIT);return t.$$set=v=>{"create"in v&&n(0,f=v.create),"edit"in v&&n(1,a=v.edit)},[f,a,d,l,o,r,i,s,c,u,h,_,b,Y,q]}class Gn extends fe{constructor(e){super(),ae(this,e,Dn,Rn,te,{create:0,edit:1})}}class Mn extends Ke.default{constructor({position:e={},...n}){const l=document.createElement("div");l.className="ogc-api-crud-tools ol-unselectable ol-control flex flex-col",Object.keys(e).forEach(o=>{l.style[o]=e[o]}),new Gn({target:l,props:n}),super({element:l})}}function Yn(t){let e,n,l,o,r,i;const s=t[5].default,f=et(s,t,t[4],null);return{c(){e=L("button"),f&&f.c(),e.disabled=n=!t[0],g(e,"class",l=`px-4 py-1 text-sm text-white ${t[1]} disabled:${t[1]}/75 font-semibold rounded-full border border-transparent focus:outline-none hover:enabled:ring-2 ${t[2]} hover:enabled:ring-offset-2`)},m(a,d){T(a,e,d),f&&f.m(e,null),o=!0,r||(i=se(e,"click",function(){we(t[3])&&t[3].apply(this,arguments)}),r=!0)},p(a,[d]){t=a,f&&f.p&&(!o||d&16)&&lt(f,s,t,t[4],o?nt(s,t[4],d,null):ot(t[4]),null),(!o||d&1&&n!==(n=!t[0]))&&(e.disabled=n),(!o||d&6&&l!==(l=`px-4 py-1 text-sm text-white ${t[1]} disabled:${t[1]}/75 font-semibold rounded-full border border-transparent focus:outline-none hover:enabled:ring-2 ${t[2]} hover:enabled:ring-offset-2`))&&g(e,"class",l)},i(a){o||(y(f,a),o=!0)},o(a){S(f,a),o=!1},d(a){a&&O(e),f&&f.d(a),r=!1,i()}}}function Vn(t,e,n){let{$$slots:l={},$$scope:o}=e,{enabled:r=!0}=e,{color:i="bg-slate-300"}=e,{ringColor:s="ring-slate-300"}=e,{onClick:f}=e;return t.$$set=a=>{"enabled"in a&&n(0,r=a.enabled),"color"in a&&n(1,i=a.color),"ringColor"in a&&n(2,s=a.ringColor),"onClick"in a&&n(3,f=a.onClick),"$$scope"in a&&n(4,o=a.$$scope)},[r,i,s,f,o,l]}class ue extends fe{constructor(e){super(),ae(this,e,Vn,Yn,te,{enabled:0,color:1,ringColor:2,onClick:3})}}function Ot(t,e,n){const l=t.slice();return l[3]=e[n],l}function St(t){let e,n,l,o;function r(...i){return t[2](t[3],...i)}return{c(){e=L("input"),g(e,"type","text"),g(e,"class","w-full bg-transparent p-1 placeholder:italic placeholder:text-slate-400"),e.value=n=t[3].value,g(e,"placeholder","not set")},m(i,s){T(i,e,s),l||(o=se(e,"input",r),l=!0)},p(i,s){t=i,s&1&&n!==(n=t[3].value)&&e.value!==n&&(e.value=n)},d(i){i&&O(e),l=!1,o()}}}function Tt(t){let e,n,l=t[3].label+"",o,r,i,s,f,a,d=t[3].isValue&&St(t);return{c(){e=L("tr"),n=L("td"),o=B(l),s=F(),f=L("td"),d&&d.c(),a=F(),g(n,"class",r=`w-1/3 p-1 pl-${t[3].depth*4}`),g(n,"title",i=t[3].name),g(e,"class","even:bg-slate-300/40"),X(e,"font-bold",t[3].isDirty)},m(c,u){T(c,e,u),w(e,n),w(n,o),w(e,s),w(e,f),d&&d.m(f,null),w(e,a)},p(c,u){u&1&&l!==(l=c[3].label+"")&&ye(o,l),u&1&&r!==(r=`w-1/3 p-1 pl-${c[3].depth*4}`)&&g(n,"class",r),u&1&&i!==(i=c[3].name)&&g(n,"title",i),c[3].isValue?d?d.p(c,u):(d=St(c),d.c(),d.m(f,null)):d&&(d.d(1),d=null),u&1&&X(e,"font-bold",c[3].isDirty)},d(c){c&&O(e),d&&d.d()}}}function zn(t){let e,n=t[0],l=[];for(let o=0;o<n.length;o+=1)l[o]=Tt(Ot(t,n,o));return{c(){e=L("table");for(let o=0;o<l.length;o+=1)l[o].c();g(e,"class","w-full border-collapse text-sm")},m(o,r){T(o,e,r);for(let i=0;i<l.length;i+=1)l[i].m(e,null)},p(o,[r]){if(r&3){n=o[0];let i;for(i=0;i<n.length;i+=1){const s=Ot(o,n,i);l[i]?l[i].p(s,r):(l[i]=Tt(s),l[i].c(),l[i].m(e,null))}for(;i<l.length;i+=1)l[i].d(1);l.length=n.length}},i:H,o:H,d(o){o&&O(e),rt(l,o)}}}function qn(t,e,n){let{editables:l=[]}=e;const o=(i,s)=>{oe.update((f={})=>({...f,[i]:s}))},r=(i,s)=>o(i.name,s.target.value);return t.$$set=i=>{"editables"in i&&n(0,l=i.editables)},[l,o,r]}class Hn extends fe{constructor(e){super(),ae(this,e,qn,zn,te,{editables:0})}}function Jn(t){let e;return{c(){e=B("Save")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function Un(t){let e;return{c(){e=B("Cancel")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function Bn(t){let e;return{c(){e=B("Delete")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function Lt(t){let e;return{c(){e=L("div"),e.innerHTML='<div class="text-xl font-bold text-slate-500 animate-pulse">Saving...</div>',g(e,"id","ogc-api-editor-panel-overlay"),g(e,"class","bg-white/90 absolute w-full h-full flex justify-center items-center")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function kt(t){let e,n,l,o,r,i;return r=new ue({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[13],$$slots:{default:[Xn]},$$scope:{ctx:t}}}),{c(){e=L("div"),n=L("div"),l=B(t[8]),o=F(),J(r.$$.fragment),g(n,"class","text-xl font-bold text-slate-500 text-center"),g(e,"id","ogc-api-editor-panel-error"),g(e,"class","bg-red-200/90 absolute w-full h-full flex flex-col gap-2 justify-center items-center")},m(s,f){T(s,e,f),w(e,n),w(n,l),w(e,o),V(r,e,null),i=!0},p(s,f){(!i||f&256)&&ye(l,s[8]);const a={};f&131072&&(a.$$scope={dirty:f,ctx:s}),r.$set(a)},i(s){i||(y(r.$$.fragment,s),i=!0)},o(s){S(r.$$.fragment,s),i=!1},d(s){s&&O(e),z(r)}}}function Xn(t){let e;return{c(){e=B("Ok")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function It(t){let e,n,l,o,r,i,s,f;return r=new ue({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[14],$$slots:{default:[Zn]},$$scope:{ctx:t}}}),s=new ue({props:{color:"bg-slate-400",ringColor:"ring-slate-400",onClick:t[15],$$slots:{default:[Kn]},$$scope:{ctx:t}}}),{c(){e=L("div"),n=L("div"),n.innerHTML=`The feature was changed by somebody else since you started to edit it.
        It will now be reloaded and you will be taken back to the editor.<br/>You can either discard your changes to see what was changed remotely
        or merge your changes on top of the reloaded feature which might hide
        the remote changes.`,l=F(),o=L("div"),J(r.$$.fragment),i=F(),J(s.$$.fragment),g(n,"class","text-base text-slate-500 text-center"),g(o,"class","flex flex-row gap-2"),g(e,"id","ogc-api-editor-panel-conflict"),g(e,"class","bg-amber-100/90 absolute w-full h-full flex flex-col gap-2 justify-around items-center p-2")},m(a,d){T(a,e,d),w(e,n),w(e,l),w(e,o),V(r,o,null),w(o,i),V(s,o,null),f=!0},p(a,d){const c={};d&1&&(c.onClick=a[14]),d&131072&&(c.$$scope={dirty:d,ctx:a}),r.$set(c);const u={};d&131072&&(u.$$scope={dirty:d,ctx:a}),s.$set(u)},i(a){f||(y(r.$$.fragment,a),y(s.$$.fragment,a),f=!0)},o(a){S(r.$$.fragment,a),S(s.$$.fragment,a),f=!1},d(a){a&&O(e),z(r),z(s)}}}function Zn(t){let e;return{c(){e=B("Discard my changes")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function Kn(t){let e;return{c(){e=B("Merge my changes")},m(n,l){T(n,e,l)},d(n){n&&O(e)}}}function Qn(t){let e,n,l,o,r,i,s,f,a,d,c,u,h,_,b,Y,q,v,R,p,j;d=new ue({props:{color:"bg-sky-600",ringColor:"ring-sky-600",enabled:t[4],onClick:t[9],$$slots:{default:[Jn]},$$scope:{ctx:t}}}),u=new ue({props:{onClick:pt,$$slots:{default:[Un]},$$scope:{ctx:t}}}),_=new ue({props:{color:"bg-red-600",ringColor:"ring-red-600",enabled:t[5]===P.EDIT,onClick:t[10],$$slots:{default:[Bn]},$$scope:{ctx:t}}}),q=new Hn({props:{editables:t[6]}});let D=t[7]===G.SYNC&&Lt(),k=t[7]===G.ERROR&&kt(t),I=t[7]===G.CONFLICT&&It(t);return{c(){e=L("div"),n=L("div"),l=L("div"),o=L("h3"),r=B(t[2]),i=F(),s=L("h3"),f=B(t[3]),a=F(),J(d.$$.fragment),c=F(),J(u.$$.fragment),h=F(),J(_.$$.fragment),b=F(),Y=L("div"),J(q.$$.fragment),v=F(),D&&D.c(),R=F(),k&&k.c(),p=F(),I&&I.c(),g(o,"id","ogc-api-editor-panel-header"),g(o,"class","text-lg font-bold text-slate-700"),g(s,"id","ogc-api-editor-panel-header2"),g(s,"class","text-base font-semibold text-slate-500"),g(l,"class","flex flex-col items-center border-b-2 border-slate-500 pb-2"),g(n,"id","ogc-api-editor-panel-main"),g(n,"class","flex flex-col justify-between py-2 px-4 min-w-[150px]"),g(Y,"id","ogc-api-editor-panel-attributes"),g(Y,"class","grow p-2 overflow-y-auto"),g(e,"id","ogc-api-editor-panel"),g(e,"class","ol-unselectable font-sans bg-white/90 text-slate-700 flex transform absolute bottom-0 left-0 w-full h-1/4 ease-in-out transition-transform duration-1000 pointer-events-auto"),X(e,"translate-y-full",t[1]),X(e,"translate-y-0",!t[1])},m(C,m){T(C,e,m),w(e,n),w(n,l),w(l,o),w(o,r),w(l,i),w(l,s),w(s,f),w(n,a),V(d,n,null),w(n,c),V(u,n,null),w(n,h),V(_,n,null),w(e,b),w(e,Y),V(q,Y,null),w(e,v),D&&D.m(e,null),w(e,R),k&&k.m(e,null),w(e,p),I&&I.m(e,null),j=!0},p(C,[m]){(!j||m&4)&&ye(r,C[2]),(!j||m&8)&&ye(f,C[3]);const Je={};m&16&&(Je.enabled=C[4]),m&131072&&(Je.$$scope={dirty:m,ctx:C}),d.$set(Je);const Nt={};m&131072&&(Nt.$$scope={dirty:m,ctx:C}),u.$set(Nt);const Ue={};m&32&&(Ue.enabled=C[5]===P.EDIT),m&131072&&(Ue.$$scope={dirty:m,ctx:C}),_.$set(Ue);const Pt={};m&64&&(Pt.editables=C[6]),q.$set(Pt),C[7]===G.SYNC?D||(D=Lt(),D.c(),D.m(e,R)):D&&(D.d(1),D=null),C[7]===G.ERROR?k?(k.p(C,m),m&128&&y(k,1)):(k=kt(C),k.c(),y(k,1),k.m(e,p)):k&&(me(),S(k,1,1,()=>{k=null}),_e()),C[7]===G.CONFLICT?I?(I.p(C,m),m&128&&y(I,1)):(I=It(C),I.c(),y(I,1),I.m(e,null)):I&&(me(),S(I,1,1,()=>{I=null}),_e()),m&2&&X(e,"translate-y-full",C[1]),m&2&&X(e,"translate-y-0",!C[1])},i(C){j||(y(d.$$.fragment,C),y(u.$$.fragment,C),y(_.$$.fragment,C),y(q.$$.fragment,C),y(k),y(I),j=!0)},o(C){S(d.$$.fragment,C),S(u.$$.fragment,C),S(_.$$.fragment,C),S(q.$$.fragment,C),S(k),S(I),j=!1},d(C){C&&O(e),z(d),z(u),z(_),z(q),D&&D.d(),k&&k.d(),I&&I.d()}}}function Wn(t,e,n){let l,o,r,i,s,f,a,d;U(t,W,p=>n(1,l=p)),U(t,$,p=>n(2,o=p)),U(t,mt,p=>n(3,r=p)),U(t,bt,p=>n(4,i=p)),U(t,x,p=>n(5,s=p)),U(t,dn,p=>n(6,f=p)),U(t,Z,p=>n(7,a=p)),U(t,gt,p=>n(8,d=p));let{onSaveAsync:c}=e,{onDeleteAsync:u}=e;const h={},_=p=>p.then(j=>{j?(console.log("CONFLICT"),n(0,h.discard=j,h)):(console.log("CLEARING"),pt())}).catch(j=>{console.log("ERROR",j),gt.set(j.message),Z.set(G.ERROR)}),b=()=>(Z.set(G.SYNC),_(c())),Y=()=>(Z.set(G.SYNC),_(u())),q=()=>Z.set(G.IDLE),v=()=>{h.discard(),Z.set(G.IDLE)},R=()=>{Z.set(G.IDLE)};return t.$$set=p=>{"onSaveAsync"in p&&n(11,c=p.onSaveAsync),"onDeleteAsync"in p&&n(12,u=p.onDeleteAsync)},[h,l,o,r,i,s,f,a,d,b,Y,c,u,q,v,R]}class $n extends fe{constructor(e){super(),ae(this,e,Wn,Qn,te,{onSaveAsync:11,onDeleteAsync:12})}}class xn extends Ke.default{constructor({map:e,...n}){const l=e.getOverlayContainerStopEvent();new $n({target:l,props:n}),super({})}setMap(e){e.render()}}var nl="";const He=(t=1e3)=>new Promise(e=>setTimeout(e,t));class el{constructor({api:e={},tools:n={},dryRun:l=!1}={}){this.api={crs:"http://www.opengis.net/def/crs/OGC/1.3/CRS84",styleFunction:void 0,...e,schemas:{custom:null,create:"schema?type=create",replace:"schema?type=replace",update:"schema?type=update",...e.schemas||{}},capabilities:{crs:!1,patch:!1,maxAllowableOffset:!1,...e.capabilities||{}}},this.tools={create:["Point","Polygon"],edit:!0,initial:"CREATE",position:{top:"5rem",left:"0.5rem"},styleFunction:void 0,styleOptions:{color:"green",strokeWidth:2,circleRadius:5,fillOpacity:""},...n},this.tools.styleFunction||(this.tools.styleFunction=bn(this.tools.styleOptions)),this.dryRun=l}addToMap(e){const{url:n,collections:l,crs:o,styleFunction:r}=this.api,i=l[0],s={[i]:{id:i,crs:o}};$.set(i);const f=Object.values(s).map(c=>Zt(n,c.id).then(u=>{console.log(u);const h=Ye(u.properties.properties,u.$defs);console.log(h);const _=dt(u.properties.geometry,u.$defs);console.log(_),_.length>0&&Te.update(b=>b||_[0]),Ie.update(b=>({...b,[c.id]:{...c,label:u.title,properties:h.properties,geoTypes:_}}))}));Promise.all(f).then(c=>console.log("INITIALIZED",c));const a=this.items=rn(n,i,1e3,o,r),d=sn(o,this.tools.styleFunction,e.getView().getProjection());e.addControl(new Mn(this.tools)),e.addControl(new xn({map:e,onSaveAsync:()=>{const c=cn(e.getView().getProjection(),o);return this._syncChanges(c)},onDeleteAsync:this._deleteFeature.bind(this)})),e.addInteraction(hn(d.getSource())),this.tools.create&&e.getInteractions().extend(_n(d.getSource(),s[i])),this.tools.edit&&(e.addInteraction(gn(d.getSource())),e.addInteraction(mn(n,s,a.getSource()))),e.addLayer(a),e.addLayer(d),this.geoJson=fn(e.getView().getProjection(),o)}_syncChanges(e){if(console.log("_syncChanges"),N(bt)){const n=N(Ie)[N($)];return N(x)===P.CREATE?this.dryRun?(console.log("POST",n.id,e),He()):Ut(this.api.url,n.id,e,this.api.crs).then(l=>{console.log("id",l);const o=this.geoJson.readFeature({...e,id:l});this.items.getSource().addFeature(o)}):this.dryRun?(console.log("PUT",n.id,e.id,e),He()):Bt(this.api.url,n.id,e,this.api.crs,N(ke)).then(()=>{const l=this.geoJson.readFeature(e);this.items.getSource().addFeature(l)}).catch(l=>{if(l.message.indexOf("412")===0){const o=()=>{le.set(void 0),oe.set(void 0)};return Qe(this.api.url,n.id,e.id,n.crs).then(r=>(K.set(r.feature),ke.set(r.etag),Z.set(G.CONFLICT),o))}else throw l})}return Promise.resolve()}_deleteFeature(){if(N(K))return pe.set(void 0),this.dryRun?(console.log("DELETE",N($),N(K).id),He()):Xt(this.api.url,N($),N(K).id).then(()=>{})}}return el});
